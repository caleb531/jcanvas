/*!
jCanvas v5.3b
Copyright 2012, Caleb Evans
Licensed under the MIT license
*/
(function(v,E,c,s,G,r,n,t,K,u,w){var x,M,D=v.extend,I=s.round,d=s.PI,o=s.sin,b=s.cos,k=v.event.fix,q={},A,B;function C(){}function J(N){if(N){D(M,N)}else{M=C.prototype=D({},x)}return this}J.version="5.3b";J.events={};v.fn.jCanvas=J;x={align:"center",angle:0,baseline:"middle",ccw:K,closed:K,compositing:"source-over",cornerRadius:0,cropFromCenter:t,each:u,end:360,fillStyle:"transparent",font:"12pt sans-serif",fromCenter:t,height:u,inDegrees:t,load:u,mask:K,opacity:1,projection:0,r1:u,r2:u,radius:0,repeat:"repeat",rounded:K,scaleX:1,scaleY:1,shadowBlur:3,shadowColor:"transparent",shadowX:0,shadowY:0,sHeight:0,sides:3,source:"",start:0,strokeCap:"butt",strokeJoin:"miter",strokeStyle:"transparent",strokeWidth:1,sWidth:0,sx:u,sy:u,text:"",visible:t,width:u,x:0,x1:0,x2:0,y:0,y1:0,y2:0};J();function y(O){var N;O=O||{};for(N in M){if(M.hasOwnProperty(N)&&O[N]===undefined){O[N]=M[N]}}return O}function a(N,O){N.fillStyle=O.fillStyle;N.strokeStyle=O.strokeStyle;N.lineWidth=O.strokeWidth;if(O.rounded){N.lineCap="round";N.lineJoin="round"}else{N.lineCap=O.strokeCap;N.lineJoin=O.strokeJoin}N.shadowOffsetX=O.shadowX;N.shadowOffsetY=O.shadowY;N.shadowBlur=O.shadowBlur;N.shadowColor=O.shadowColor;N.globalAlpha=O.opacity;N.globalCompositeOperation=O.compositing}q.x=[];q.y=[];function z(N){J.events[N]=function(O){O.unbind(N+".jCanvas").bind(N+".jCanvas",function(P){q.x[0]=P.offsetX;q.y[0]=P.offsetY;q.type=P.type;O.drawLayers()})}}z("click");z("dblclick");z("mousedown");z("mouseup");z("mousemove");J.events.mouseover=J.events.mouseout=function(N){N.unbind("mousemove.jCanvasHover").bind("mousemove.jCanvasHover",function(O){q.x[1]=q.x[0];q.y[1]=q.y[0];q.x[0]=O.offsetX;q.y[0]=O.offsetY;q.type="hover";N.drawLayers()})};function e(N){N.mouseX=q.x[0];N.mouseY=q.y[0];q.x[0]=w;q.y[0]=w}function H(Q,N,P){var S=P[q.type],R=N.isPointInPath(q.x[0],q.y[0]),O=N.isPointInPath(q.x[1],q.y[1]);if(q.type==="hover"&&R&&!P.hovered){P.hovered=t;e(P);if(P.mouseover){P.mouseover.call(Q,P);a(N,P)}}else{if(q.type==="hover"&&!R&&O&&P.hovered){P.hovered=K;e(P);if(P.mouseout){P.mouseout.call(Q,P);a(N,P)}}else{if(q.type!=="hover"&&S&&R){e(P);S.call(Q,P);a(N,P)}}}}function i(N){return(N.getContext?N.getContext("2d"):u)}function p(N,O){if(O.mask){N.save();N.clip()}if(O.closed){N.closePath();N.fill();N.stroke()}else{N.fill();N.stroke();N.closePath()}}function g(O,Q,P,N){Q.toRad=(Q.inDegrees?d/180:1);O.save();if(!Q.fromCenter){Q.x+=P/2;Q.y+=N/2}if(Q.angle){O.translate(Q.x,Q.y);O.rotate(Q.angle*Q.toRad);O.translate(-Q.x,-Q.y)}}function m(N){N=N||{};x=D(x,N.props);J();if(N.name){v.fn[N.name]=function(R){var S=this,P,Q,O;R=R=y(R);for(Q=0;Q<S.length;Q+=1){P=S[Q];O=i(P);if(O){a(O,R);N.fn.call(P,O,R)}}return S}}return v.fn[N.name]}v.fn.loadCanvas=function(){return i(this[0])};v.fn.getCanvasImage=function(N){var O=this[0];if(!O||!O.toDataURL){return u}if(N===w){N="image/png"}else{N=N.replace(/^([a-z]+)$/gi,"image/$1").replace(/jpg/gi,"jpeg")}return O.toDataURL(N)};v.fn.draw=function(Q){var P=this,N,O;for(O=0;O<P.length;O+=1){N=i(P[O]);if(N){Q.call(P[O],N)}}return P};v.fn.gradient=function(R){var N=this,Y,W,X=[],U,P,S,T,V,Q,O;R=y(R);Y=i(N[0]);if(Y){if(R.c2===w){W=R.c1}else{if(R.r1!==u||R.r2!==u){W=Y.createRadialGradient(R.x1,R.y1,R.r1,R.x2,R.y2,R.r2)}else{W=Y.createLinearGradient(R.x1,R.y1,R.x2,R.y2)}for(T=1;R["c"+T]!==w;T+=1){if(R["s"+T]!==w){X.push(R["s"+T])}else{X.push(u)}}U=X.length;if(X[0]===u){X[0]=0}if(X[U-1]===u){X[U-1]=1}for(T=0;T<U;T+=1){if(X[T]!==u&&X[T]!==1){V=T+1;Q=1;O=0;P=X[T];for(V=(T+1);V<U;V+=1){if(X[V]!==u){S=X[V];break}else{Q+=1}}if(P>S){X[V]=X[T]}}else{if(X[T]===u){O+=1;X[T]=P+(O*((S-P)/Q))}}W.addColorStop(X[T],R["c"+(T+1)])}}}else{W=u}return W};v.fn.pattern=function(S){var U=this,N,O,Q;S=y(S);function P(){var V=K;if(O.complete){Q=N.createPattern(O,S.repeat);V=t}return V}function T(){if(S.load){S.load.call(U[0],Q)}}function R(){P();T()}N=i(U[0]);if(N){O=new G();if(S.source.src){O=S.source}else{O.src=S.source}if(!O.complete&&S.load){O.onload=R}else{if(!P()){O.onload=R}else{T()}}}else{Q=u}return Q};v.fn.clearCanvas=function(P){var Q=this,O,N;P=y(P);for(O=0;O<Q.length;O+=1){N=i(Q[O]);if(N){g(N,P,P.width,P.height);if(!P.width&&!P.height){N.clearRect(0,0,Q[O].width,Q[O].height)}else{N.clearRect(P.x-P.width/2,P.y-P.height/2,P.width,P.height)}}}return Q};v.fn.saveCanvas=function(){var P=this,N,O;for(O=0;O<P.length;O+=1){N=i(P[O]);if(N){N.save()}}return P};v.fn.restoreCanvas=function(){var P=this,N,O;for(O=0;O<P.length;O+=1){N=i(P[O]);if(N){N.restore()}}return P};v.fn.scaleCanvas=function(P){var Q=this,O,N;P=y(P);for(O=0;O<Q.length;O+=1){N=i(Q[O]);if(N){N.save();N.translate(P.x,P.y);N.scale(P.scaleX,P.scaleY);N.translate(-P.x,-P.y)}}return Q};v.fn.translateCanvas=function(P){var Q=this,O,N;P=y(P);for(O=0;O<Q.length;O+=1){N=i(Q[O]);if(N){N.save();N.translate(P.x,P.y)}}return Q};v.fn.rotateCanvas=function(P){var Q=this,O,N;P=y(P);for(O=0;O<Q.length;O+=1){N=i(Q[O]);if(N){g(N,P,0,0)}}return Q};v.fn.drawRect=function(R){var O=this,S,V,Q,U,P,T,N;R=y(R);for(S=0;S<O.length;S+=1){V=i(O[S]);if(V){a(V,R);g(V,R,R.width,R.height);V.beginPath();if(R.cornerRadius){R.closed=t;Q=R.x-R.width/2;U=R.y-R.height/2;P=R.x+R.width/2;T=R.y+R.height/2;N=R.cornerRadius;if((P-Q)-(2*N)<0){N=(P-Q)/2}if((T-U)-(2*N)<0){N=(T-U)/2}V.moveTo(Q+N,U);V.lineTo(P-N,U);V.arc(P-N,U+N,N,3*d/2,d*2,K);V.lineTo(P,T-N);V.arc(P-N,T-N,N,0,d/2,K);V.lineTo(Q+N,T);V.arc(Q+N,T-N,N,d/2,d,K);V.lineTo(Q,U+N);V.arc(Q+N,U+N,N,d,3*d/2,K)}else{V.rect(R.x-R.width/2,R.y-R.height/2,R.width,R.height)}V.restore();if(R.event){H(O[S],V,R)}p(V,R)}}return O};v.fn.drawArc=function(P){var Q=this,O,N;P=y(P);if(!P.inDegrees&&P.end===360){P.end=d*2}for(O=0;O<Q.length;O+=1){N=i(Q[O]);if(N){a(N,P);g(N,P,P.radius*2,P.radius*2);N.beginPath();N.arc(P.x,P.y,P.radius,(P.start*P.toRad)-(d/2),(P.end*P.toRad)-(d/2),P.ccw);N.restore();if(P.event){H(Q[O],N,P)}p(N,P)}}return Q};v.fn.drawEllipse=function(Q){Q=y(Q);var R=this,P,N,O=Q.width*4/3;for(P=0;P<R.length;P+=1){N=i(R[P]);if(N){a(N,Q);g(N,Q,Q.width,Q.height);N.beginPath();N.moveTo(Q.x,Q.y-Q.height/2);N.bezierCurveTo(Q.x-O/2,Q.y-Q.height/2,Q.x-O/2,Q.y+Q.height/2,Q.x,Q.y+Q.height/2);N.bezierCurveTo(Q.x+O/2,Q.y+Q.height/2,Q.x+O/2,Q.y-Q.height/2,Q.x,Q.y-Q.height/2);N.restore();if(Q.event){H(R[P],N,Q)}p(N,Q)}}return R};v.fn.drawLine=function(S){var T=this,R,O,N=2,Q=0,P=0;S=y(S);for(R=0;R<T.length;R+=1){O=i(T[R]);if(O){a(O,S);O.beginPath();O.moveTo(S.x1,S.y1);while(t){Q=S["x"+N];P=S["y"+N];if(Q!==w&&P!==w){O.lineTo(Q,P);N+=1}else{break}}if(S.event){H(T[R],O,S)}p(O,S)}}return T};v.fn.drawQuad=function(R){var N=this,S,V,Q=2,P=0,O=0,U=0,T=0;R=y(R);for(S=0;S<N.length;S+=1){V=i(N[S]);if(V){a(V,R);V.beginPath();V.moveTo(R.x1,R.y1);while(t){P=R["x"+Q];O=R["y"+Q];U=R["cx"+(Q-1)];T=R["cy"+(Q-1)];if(P!==w&&O!==w&&U!==w&&T!==w){V.quadraticCurveTo(U,T,P,O);Q+=1}else{break}}if(R.event){H(N[S],V,R)}p(V,R)}}return N};v.fn.drawBezier=function(U){var N=this,X,Y,T=2,Q=1,S=0,R=0,W=0,P=0,V=0,O=0;U=y(U);for(X=0;X<N.length;X+=1){Y=i(N[X]);if(Y){a(Y,U);Y.beginPath();Y.moveTo(U.x1,U.y1);while(t){S=U["x"+T];R=U["y"+T];W=U["cx"+Q];P=U["cy"+Q];V=U["cx"+(Q+1)];O=U["cy"+(Q+1)];if(S!==w&&R!==w&&W!==w&&P!==w&&V!==w&&O!==w){Y.bezierCurveTo(W,P,V,O,S,R);T+=1;Q+=2}else{break}}if(U.event){H(N[X],Y,U)}p(Y,U)}}return N};v.fn.drawText=function(Q){var R=this,O,P,N;Q=y(Q);for(P=0;P<R.length;P+=1){O=v(R[P]);N=i(O[0]);if(N){a(N,Q);N.textBaseline=Q.baseline;N.textAlign=Q.align;N.font=Q.font;N.strokeText(Q.text,Q.x,Q.y);N.fillText(Q.text,Q.x,Q.y)}}return R};v.fn.drawImage=function(R){var N=this,W,P,T,S,O;R=y(R);if(R.source.src){S=R.source}else{if(R.source){S=new G();S.src=R.source}}function U(X){if(S.complete===w||S.complete===t){O=S.width/S.height;R.sWidth=R.sWidth||S.width;R.sHeight=R.sHeight||S.height;if(R.sWidth>S.width){R.sWidth=S.width}if(R.sHeight>S.height){R.sHeight=S.height}if(R.width===u&&R.sWidth!==S.width){R.width=R.sWidth}if(R.height===u&&R.sHeight!==S.height){R.height=R.sHeight}if(R.sx===u){if(R.cropFromCenter){R.sx=S.width/2}else{R.sx=0}}if(R.sy===u){if(R.cropFromCenter){R.sy=S.height/2}else{R.sy=0}}if(!R.cropFromCenter){R.sx+=R.sWidth/2;R.sy+=R.sHeight/2}if((R.sx+R.sWidth/2)>S.width){R.sx=S.width-R.sWidth/2}if((R.sx-R.sWidth/2)<0){R.sx=R.sWidth/2}if((R.sy-R.sHeight/2)<0){R.sy=R.sHeight/2}if((R.sy+R.sHeight/2)>S.height){R.sy=S.height-R.sHeight/2}if(R.width!==u&&R.height===u){R.height=R.height=R.width/O}else{if(R.width===u&&R.height!==u){R.width=R.width=R.height*O}else{if(R.width===u&&R.height===u){R.width=R.width=S.width;R.height=R.height=S.height}}}g(X,R,R.width,R.height);X.drawImage(S,R.sx-R.sWidth/2,R.sy-R.sHeight/2,R.sWidth,R.sHeight,R.x-R.width/2,R.y-R.height/2,R.width,R.height);if(R.event){X.fillStyle="#000";X.beginPath();X.rect(R.x-R.width/2,R.y-R.height/2,R.width,R.height);X.restore();H(N[T],X,R);X.closePath()}else{X.restore()}return t}}function V(){if(R.load){R.load.call(P)}}function Q(){U(W);V()}for(T=0;T<N.length;T+=1){P=N[T];W=i(N[T]);if(W){a(W,R);if(!S.complete&&R.load){S.onload=Q}else{if(!U(W)){S.onload=Q}else{V()}}}}return N};v.fn.drawPolygon=function(R){R=y(R);var N=this,T,Y,Z=d/R.sides,Q=(d/2)+Z,X=(d*2)/R.sides,W=b(X/2)*R.radius,P,V,O,U,S;R.closed=t;if(R.sides>2){for(T=0;T<N.length;T+=1){Y=i(N[T]);if(Y){a(Y,R);g(Y,R,R.radius,R.radius);Y.beginPath();for(S=0;S<R.sides;S+=1){P=R.x+I(R.radius*b(Q));V=R.y+I(R.radius*o(Q));if(S===0){Y.moveTo(P,V)}else{Y.lineTo(P,V)}if(R.projection){O=R.x+I((W+W*R.projection)*b(Q+Z));U=R.y+I((W+W*R.projection)*o(Q+Z));Y.lineTo(O,U)}Q+=X}Y.restore();if(R.event){H(N[T],Y,R)}p(Y,R)}}}return N};v.fn.setPixels=function(Q){var N=this,W,P,U,S,O,R,T,V={};Q=y(Q);for(U=0;U<N.length;U+=1){P=N[U];W=i(N[U]);if(W){if(!Q.x&&!Q.y&&!Q.width&&!Q.height){Q.width=P.width;Q.height=P.height;Q.x=Q.width/2;Q.y=Q.height/2}g(W,Q,Q.width,Q.height);O=W.getImageData(Q.x-Q.width/2,Q.y-Q.height/2,Q.width,Q.height);R=O.data;T=R.length;V=[];if(Q.each!==u){for(S=0;S<T;S+=4){V.index=S/4;V.r=R[S];V.g=R[S+1];V.b=R[S+2];V.a=R[S+3];Q.each.call(P,V);R[S]=V.r;R[S+1]=V.g;R[S+2]=V.b;R[S+3]=V.a}}W.putImageData(O,Q.x-Q.width/2,Q.y-Q.height/2);W.restore()}}return N};function f(O,P){var N;for(N=0;N<O.length;N+=1){P[O[N]]=P["_"+O[N]]}}function h(O,P){var N;for(N=0;N<O.length;N+=1){P["_"+O[N]]=P[O[N]]}}A=["width","height","opacity"];B=["backgroundColor","color","borderColor","borderTopColor","borderRightColor","borderBottomColor","borderLeftColor","fillStyle","strokeStyle","shadowColor"];function j(O){var R,Q,P=[],N=1;if(typeof O==="object"){P=O}else{if(O.match(/^[a-z]+$/gi)){if(O==="transparent"){O="rgba(255,255,255,0)"}Q=c.documentElement;R=Q.style.color;Q.style.color=O;O=v.css(Q,"color");Q.style.color=R}if(O.match(/^\#/gi)){if(O.length===4){O=O.replace(/([0-9a-f])/gi,"$1$1")}P=O.match(/[0-9a-f]{2}/gi);P[0]=n(P[0],16);P[1]=n(P[1],16);P[2]=n(P[2],16)}else{if(O.match(/^rgb/gi)){P=O.match(/[0-9\.]+/gi);if(O.match(/\%/gi)){N=2.55}P[0]=P[0]*N;P[1]=P[1]*N;P[2]=P[2]*N}}if(O.match("rgba")){P[3]=r(P[3])}else{P[3]=1}}return P}function L(O,N){O.now[N]=O.start[N]+(O.end[N]-O.start[N])*O.pos;if(N<3){O.now[N]=I(O.now[N])}}function F(N){if(typeof N.start!=="object"){N.start=j(N.start);N.end=j(N.end)}N.now=[];L(N,0);L(N,1);L(N,2);L(N,3);N.now="rgba("+N.now.join(",")+")";if(N.elem.style){N.elem.style[N.prop]=N.now}else{N.elem[N.prop]=N.now}}function l(N){var O;for(O=0;O<N.length;O+=1){if(!v.fx.step[N[O]]){v.fx.step[N[O]]=F}}}v.fn.getLayers=function(){var N=this[0],O;if(!N||!N.getContext){return u}O=v.data(N,"jCanvas-layers");if(!O){O=[];v.data(N,"jCanvas-layers",O)}return O};v.fn.getLayer=function(N){var Q=this.getLayers(),P,O;if(!Q){P=u}else{if(typeof N==="string"){for(O=0;O<Q.length;O+=1){if(Q[O].name===N){N=O;break}}}}N=N||0;P=Q[N];return P};v.fn.addLayer=function(R){var S=this,N,Q,O,P;R=y(R);R.layer=t;for(P=0;P<S.length;P+=1){N=v(S[P]);if(i(S[P])){Q=N.getLayers();if(typeof R==="function"){R.method="draw"}else{if(R.method!=="drawImage"){R.width=R.width||0;R.height=R.height||0}for(O in J.events){if(J.events.hasOwnProperty(O)&&R[O]){J.events[O].call(E,N);R.event=t}}}Q.push(R)}}S.drawLayers();return S};v.fn.removeLayers=function(){var P=this,O,N;for(N=0;N<P.length;N+=1){O=v(P[N]).getLayers()||[];O.length=0}return this};v.fn.removeLayer=function(N){var S=this,R,P=typeof N,Q,O;for(R=0;R<S.length;R+=1){Q=v(S[R]).getLayers()||[];if(P==="string"){for(O=0;O<Q.length;O+=1){if(Q[O].name===N){Q.splice(O,1);break}}}else{if(P==="number"){Q.splice(N,1)}}}return this};v.fn.drawLayers=function(){var T=this,O,N,S,R,Q,P;for(Q=0;Q<T.length;Q+=1){O=v(T[Q]);N=i(O[0]);if(N){R=O.getLayers();N.clearRect(0,0,O[0].width,O[0].height);for(P=0;P<R.length;P+=1){S=R[P];if(S.visible){if(S.method==="draw"){S.call(O[0],N)}else{if(v.fn[S.method]){v.fn[S.method].call(O,S)}}}}}}return T};v.fn.animateLayer=function(){var T=this,O,R,S=([]).slice.call(arguments,0),P;if(typeof S[0]==="object"&&!S[0].layer){S.unshift(0)}if(S[2]===w){S.splice(2,0,u);S.splice(3,0,u);S.splice(4,0,function(){})}else{if(typeof S[2]==="function"){S.splice(2,0,u);S.splice(3,0,u)}}if(S[3]===w){S[3]=u;S.splice(4,0,function(){})}else{if(typeof S[3]==="function"){S.splice(3,0,u)}}if(S[4]===w){S[4]=function(){}}function N(U,V){return function(){f(A,V);U.drawLayers();S[4].call(U[0])}}function Q(U,V){return function(){f(A,V);U.drawLayers()}}for(R=0;R<T.length;R+=1){O=v(T[R]);if(i(T[R])){if(S[0].layer){P=S[0]}else{P=O.getLayer(S[0])}if(P&&P.method!=="draw"){h(A,P);h(A,S[1]);v(P).animate(S[1],{duration:S[2],easing:(v.easing[S[3]]?S[3]:u),complete:N(O,P),step:Q(O,P)})}}}return T};v.event.fix=function(N){var O;N=k.call(v.event,N);if(N.pageX!==w&&N.offsetX===w){O=v(N.target).offset();if(O){N.offsetX=N.pageX-O.left;N.offsetY=N.pageY-O.top}}return N};l(B);v.support.canvas=(c.createElement("canvas").getContext!==w);J.defaults=x;J.prefs=M;J.extend=m;v.jCanvas=J}(jQuery,window,document,Math,Image,parseFloat,parseInt,true,false,null));
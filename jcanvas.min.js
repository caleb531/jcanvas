/*
 jCanvas v14.08.25
 Copyright 2014 Caleb Evans
 Released under the MIT license
*/
(function(g,ra,sa,Ma,Z,X,B,w,k,s){function ga(d){for(var c in d)d.hasOwnProperty(c)&&(this[c]=d[c]);return this}function J(d){function c(){}c.prototype=d;var a=new c;a._layer=d;return a}function ha(){T(this,ha.baseDefaults)}function ea(d){return"string"===W(d)}function H(d){return d&&d.getContext?d.getContext("2d"):k}function ia(d){var c,a,b;for(c in d)d.hasOwnProperty(c)&&(b=d[c],a=W(b),"string"!==a||""===b||isNaN(b)||(d[c]=X(b)));d.text=String(d.text)}function fa(d){d=T({},d);d.masks=d.masks.slice(0);
return d}function ta(d,c){var a;d.save();a=fa(c.transforms);c.savedTransforms.push(a)}function ua(d,c,a,b){a[b]&&($(a[b])?c[b]=a[b].call(d,a):c[b]=a[b])}function O(d,c,a){ua(d,c,a,"fillStyle");ua(d,c,a,"strokeStyle");c.lineWidth=a.strokeWidth;a.rounded?c.lineCap=c.lineJoin="round":(c.lineCap=a.strokeCap,c.lineJoin=a.strokeJoin,c.miterLimit=a.miterLimit);a.strokeDash||(a.strokeDash=[]);c.setLineDash&&c.setLineDash(a.strokeDash);c.webkitLineDash=c.mozDash=a.strokeDash;c.lineDashOffset=c.webkitLineDashOffset=
c.mozDashOffset=a.strokeDashOffset;c.shadowOffsetX=a.shadowX;c.shadowOffsetY=a.shadowY;c.shadowBlur=a.shadowBlur;c.shadowColor=a.shadowColor;c.globalAlpha=a.opacity;c.globalCompositeOperation=a.compositing;a.imageSmoothing&&(c.webkitImageSmoothingEnabled=c.mozImageSmoothingEnabled=a.imageSmoothing)}function va(d,c,a){a=a._layer;a.mask&&(a.autosave&&ta(d,c),d.clip(),c.transforms.masks.push(a))}function R(d,c,a){a.closed&&c.closePath();a.shadowStroke&&0!==a.strokeWidth?(c.stroke(),c.fill(),c.shadowColor=
"transparent",c.shadowBlur=0,c.stroke()):(c.fill(),"transparent"!==a.fillStyle&&(c.shadowColor="transparent"),0!==a.strokeWidth&&c.stroke());a.closed||c.closePath();a._transformed&&c.restore();a.mask&&(d=I(d),va(c,d,a))}function N(d,c,a,b,e){a._toRad=a.inDegrees?C/180:1;a._transformed=B;c.save();a.fromCenter||a._centered||b===s||(e===s&&(e=b),a.x+=b/2,a.y+=e/2,a._centered=B);a.rotate&&(d=k,a._toRad=a.inDegrees?C/180:1,c.translate(a.x,a.y),c.rotate(a.rotate*a._toRad),c.translate(-a.x,-a.y),d&&(d.rotate+=
a.rotate*a._toRad));if(1!==a.scale||1!==a.scaleX||1!==a.scaleY)d=k,1!==a.scale&&(a.scaleX=a.scaleY=a.scale),c.translate(a.x,a.y),c.scale(a.scaleX,a.scaleY),c.translate(-a.x,-a.y),d&&(d.scaleX*=a.scaleX,d.scaleY*=a.scaleY);if(a.translate||a.translateX||a.translateY)d=k,a.translate&&(a.translateX=a.translateY=a.translate),c.translate(a.translateX,a.translateY),d&&(d.translateX+=a.translateX,d.translateY+=a.translateY)}function I(d){var c=Y.dataCache,a;c._canvas===d&&c._data?a=c._data:(a=g.data(d,"jCanvas"),
a||(a={canvas:d,layers:[],layer:{names:{},groups:{}},eventHooks:{},intersecting:[],lastIntersected:k,cursor:g(d).css("cursor"),drag:{layer:k,dragging:w},event:{type:k,x:k,y:k},events:{},transforms:fa(ja),savedTransforms:[],animating:w,animated:k,pixelRatio:1,scaled:w},g.data(d,"jCanvas",a)),c._canvas=d,c._data=a);return a}function wa(d,c,a){for(var b in U.events)U.events.hasOwnProperty(b)&&(a[b]||a.cursors&&a.cursors[b])&&xa(d,c,a,b)}function xa(d,c,a,b){U.events[b](d,c);a._event=B}function ya(d,
c,a){var b,e,f;if(a.draggable||a.cursors){b=["mousedown","mousemove","mouseup"];for(f=0;f<b.length;f+=1)e=b[f],xa(d,c,a,e);c.events.mouseoutdrag||(d.bind("mouseout.jCanvas",function(){var a=c.drag.layer;a&&(c.drag={},K(d,c,a,"dragcancel"),d.drawLayers())}),c.events.mouseoutdrag=B);a._event=B}}function ka(d,c,a,b){d=c.layer.names;b?b.name!==s&&ea(a.name)&&a.name!==b.name&&delete d[a.name]:b=a;ea(b.name)&&(d[b.name]=a)}function la(d,c,a,b){d=c.layer.groups;var e,f,h,p;if(!b)b=a;else if(b.groups!==s&&
a.groups!==k)for(f=0;f<a.groups.length;f+=1)if(e=a.groups[f],c=d[e]){for(p=0;p<c.length;p+=1)if(c[p]===a){h=p;c.splice(p,1);break}0===c.length&&delete d[e]}if(b.groups!==s&&b.groups!==k)for(f=0;f<b.groups.length;f+=1)e=b.groups[f],c=d[e],c||(c=d[e]=[],c.name=e),h===s&&(h=c.length),c.splice(h,0,a)}function ma(d,c,a,b,e){b[a]&&c._running&&!c._running[a]&&(c._running[a]=B,b[a].call(d[0],c,e),c._running[a]=w)}function K(d,c,a,b,e){if(!(a.disableEvents||a.intangible&&-1!==g.inArray(b,Na))){if("mouseout"!==
b){var f;a.cursors&&(f=a.cursors[b]);-1!==g.inArray(f,Q.cursors)&&(f=Q.prefix+f);f&&d.css({cursor:f})}ma(d,a,b,a,e);ma(d,a,b,c.eventHooks,e);ma(d,a,b,U.eventHooks,e)}}function L(d,c,a){var b,e,f,h;if(c._layerAdded)return c;b=g(d);e=I(d);f=e.layers;if(c.name===s||ea(c.name)&&e.layer.names[c.name]===s)h=new ga(c),h.canvas=d,h._layerAdded=B,h._running={},h._method=a?a:h.method?g.fn[h.method]:h.type?g.fn[S.drawings[h.type]]:function(){},h.data=h.data!==k?T({},h.data):{},h.groups=h.groups!==k?h.groups.slice(0):
[],ka(b,e,h),la(b,e,h),wa(b,e,h),ya(b,e,h),h._method===g.fn.drawText&&b.measureText(h),h.index===k&&(h.index=f.length),ia(h),f.splice(h.index,0,h),K(b,e,h,"add");return h}function za(d,c){var a,b;for(b=0;b<Q.props.length;b+=1)a=Q.props[b],d[a]!==s&&(d["_"+a]=d[a],Q.propsObj[a]=B,c&&delete d[a])}function Oa(d,c,a){var b,e,f,h;for(b in a)if(a.hasOwnProperty(b)&&(e=a[b],$(e)&&(a[b]=e.call(d,c,b)),"object"===W(e)&&Aa(e))){for(f in e)e.hasOwnProperty(f)&&(h=e[f],c[b]!==s&&(c[b+"."+f]=c[b][f],a[b+"."+f]=
h));delete a[b]}return a}function Ba(d){var c,a,b=[],e=1;d.match(/^([a-z]+|#[0-9a-f]+)$/gi)&&("transparent"===d&&(d="rgba(0, 0, 0, 0)"),a=ra.head,c=a.style.color,a.style.color=d,d=g.css(a,"color"),a.style.color=c);d.match(/^rgb/gi)&&(b=d.match(/(\d+(\.\d+)?)/gi),d.match(/%/gi)&&(e=2.55),b[0]*=e,b[1]*=e,b[2]*=e,b[3]=b[3]!==s?X(b[3]):1);return b}function Pa(d){var c=3,a;"array"!==W(d.start)&&(d.start=Ba(d.start),d.end=Ba(d.end));d.now=[];if(1!==d.start[3]||1!==d.end[3])c=4;for(a=0;a<c;a+=1)d.now[a]=
d.start[a]+(d.end[a]-d.start[a])*d.pos,3>a&&(d.now[a]=Qa(d.now[a]));1!==d.start[3]||1!==d.end[3]?d.now="rgba( "+d.now.join(",")+" )":(d.now.slice(0,3),d.now="rgb( "+d.now.join(",")+" )");d.elem.nodeName?d.elem.style[d.prop]=d.now:d.elem[d.prop]=d.now}function Ra(d){S.touchEvents[d]&&(d=S.touchEvents[d]);return d}function Sa(d){U.events[d]=function(c,a){function b(a){var b,d,f={x:null,y:null};d=a.originalEvent;b=g(a.currentTarget).offset();d&&b&&(d=d.changedTouches,a.pageX!==s?f={x:a.pageX-b.left,
y:a.pageY-b.top}:d&&(f={x:d[0].pageX-b.left,y:d[0].pageY-b.top}));b=f;h.x=b.x;h.y=b.y;h.type=e;h.event=a;c.drawLayers({resetFire:B});a.preventDefault()}var e,f,h;h=a.event;e="mouseover"===d||"mouseout"===d?"mousemove":d;f=Ra(e);a.events[e]||(f!==e?c.bind(e+".jCanvas "+f+".jCanvas",b):c.bind(e+".jCanvas",b),a.events[e]=B)}}function P(d,c,a){var b,e,f,h;if(a=a._layer)d=I(d),b=d.event,b.x!==k&&b.y!==k&&(f=b.x*d.pixelRatio,h=b.y*d.pixelRatio,e=c.isPointInPath(f,h)||c.isPointInStroke&&c.isPointInStroke(f,
h)),c=d.transforms,a.eventX=b.x,a.eventY=b.y,a.event=b.event,b=d.transforms.rotate,f=a.eventX,h=a.eventY,0!==b?(a._eventX=f*G(-b)-h*M(-b),a._eventY=h*G(-b)+f*M(-b)):(a._eventX=f,a._eventY=h),a._eventX/=c.scaleX,a._eventY/=c.scaleY,e&&d.intersecting.push(a),a.intersects=!!e}function Ca(d){for(;0>d;)d+=2*C;return d}function Da(d,c,a,b){var e,f,h,p,m,z,q;a===b?q=z=0:(z=a.x,q=a.y);b.inDegrees||360!==b.end||(b.end=2*C);b.start*=a._toRad;b.end*=a._toRad;b.start-=C/2;b.end-=C/2;m=C/180;b.ccw&&(m*=-1);e=
b.x+b.radius*G(b.start+m);f=b.y+b.radius*M(b.start+m);h=b.x+b.radius*G(b.start);p=b.y+b.radius*M(b.start);aa(d,c,a,b,e,f,h,p);c.arc(b.x+z,b.y+q,b.radius,b.start,b.end,b.ccw);e=b.x+b.radius*G(b.end+m);m=b.y+b.radius*M(b.end+m);f=b.x+b.radius*G(b.end);h=b.y+b.radius*M(b.end);ba(d,c,a,b,f,h,e,m)}function Ea(d,c,a,b,e,f,h,p){var m,z;b.arrowRadius&&!a.closed&&(z=Ta(p-f,h-e),z-=C,d=a.strokeWidth*G(z),m=a.strokeWidth*M(z),a=h+b.arrowRadius*G(z+b.arrowAngle/2),e=p+b.arrowRadius*M(z+b.arrowAngle/2),f=h+b.arrowRadius*
G(z-b.arrowAngle/2),b=p+b.arrowRadius*M(z-b.arrowAngle/2),c.moveTo(a-d,e-m),c.lineTo(h-d,p-m),c.lineTo(f-d,b-m),c.moveTo(h-d,p-m),c.lineTo(h+d,p+m),c.moveTo(h,p))}function aa(d,c,a,b,e,f,h,p){b._arrowAngleConverted||(b.arrowAngle*=a._toRad,b._arrowAngleConverted=B);b.startArrow&&Ea(d,c,a,b,e,f,h,p)}function ba(d,c,a,b,e,f,h,p){b._arrowAngleConverted||(b.arrowAngle*=a._toRad,b._arrowAngleConverted=B);b.endArrow&&Ea(d,c,a,b,e,f,h,p)}function Fa(d,c,a,b){var e,f,h;e=2;aa(d,c,a,b,b.x2+a.x,b.y2+a.y,b.x1+
a.x,b.y1+a.y);for(b.x1!==s&&b.y1!==s&&c.moveTo(b.x1+a.x,b.y1+a.y);B;)if(f=b["x"+e],h=b["y"+e],f!==s&&h!==s)c.lineTo(f+a.x,h+a.y),e+=1;else break;e-=1;ba(d,c,a,b,b["x"+(e-1)]+a.x,b["y"+(e-1)]+a.y,b["x"+e]+a.x,b["y"+e]+a.y)}function Ga(d,c,a,b){var e,f,h,p,m;e=2;aa(d,c,a,b,b.cx1+a.x,b.cy1+a.y,b.x1+a.x,b.y1+a.y);for(b.x1!==s&&b.y1!==s&&c.moveTo(b.x1+a.x,b.y1+a.y);B;)if(f=b["x"+e],h=b["y"+e],p=b["cx"+(e-1)],m=b["cy"+(e-1)],f!==s&&h!==s&&p!==s&&m!==s)c.quadraticCurveTo(p+a.x,m+a.y,f+a.x,h+a.y),e+=1;else break;
e-=1;ba(d,c,a,b,b["cx"+(e-1)]+a.x,b["cy"+(e-1)]+a.y,b["x"+e]+a.x,b["y"+e]+a.y)}function Ha(d,c,a,b){var e,f,h,p,m,z,q,g;e=2;f=1;aa(d,c,a,b,b.cx1+a.x,b.cy1+a.y,b.x1+a.x,b.y1+a.y);for(b.x1!==s&&b.y1!==s&&c.moveTo(b.x1+a.x,b.y1+a.y);B;)if(h=b["x"+e],p=b["y"+e],m=b["cx"+f],z=b["cy"+f],q=b["cx"+(f+1)],g=b["cy"+(f+1)],h!==s&&p!==s&&m!==s&&z!==s&&q!==s&&g!==s)c.bezierCurveTo(m+a.x,z+a.y,q+a.x,g+a.y,h+a.x,p+a.y),e+=1,f+=2;else break;e-=1;f-=2;ba(d,c,a,b,b["cx"+(f+1)]+a.x,b["cy"+(f+1)]+a.y,b["x"+e]+a.x,b["y"+
e]+a.y)}function Ia(d,c,a){c*=d._toRad;c-=C/2;return a*G(c)}function Ja(d,c,a){c*=d._toRad;c-=C/2;return a*M(c)}function Ka(d,c,a,b){var e,f,h,p,m,z,q;a===b?m=p=0:(p=a.x,m=a.y);e=1;f=p=z=b.x+p;h=m=q=b.y+m;aa(d,c,a,b,f+Ia(a,b.a1,b.l1),h+Ja(a,b.a1,b.l1),f,h);for(b.x!==s&&b.y!==s&&c.moveTo(f,h);B;)if(f=b["a"+e],h=b["l"+e],f!==s&&h!==s)p=z,m=q,z+=Ia(a,f,h),q+=Ja(a,f,h),c.lineTo(z,q),e+=1;else break;ba(d,c,a,b,p,m,z,q)}function na(d,c,a){isNaN(Number(a.fontSize))||(a.fontSize+="px");c.font=a.fontStyle+
" "+a.fontSize+" "+a.fontFamily}function oa(d,c,a,b){var e,f;e=Y.propCache;if(e.text===a.text&&e.fontStyle===a.fontStyle&&e.fontSize===a.fontSize&&e.fontFamily===a.fontFamily&&e.maxWidth===a.maxWidth&&e.lineHeight===a.lineHeight)a.width=e.width,a.height=e.height;else{a.width=c.measureText(b[0]).width;for(f=1;f<b.length;f+=1)e=c.measureText(b[f]).width,e>a.width&&(a.width=e);c=d.style.fontSize;d.style.fontSize=a.fontSize;a.height=X(g.css(d,"fontSize"))*b.length*a.lineHeight;d.style.fontSize=c}}function La(d,
c){var a=c.maxWidth,b=c.text.split("\n"),e=[],f,h,p,m,z;for(p=0;p<b.length;p+=1){m=b[p];z=m.split(" ");f=[];h="";if(1===z.length||d.measureText(m).width<a)f=[m];else{for(m=0;m<z.length;m+=1)d.measureText(h+z[m]).width>a&&(""!==h&&f.push(h),h=""),h+=z[m],m!==z.length-1&&(h+=" ");f.push(h)}e=e.concat(f.join("\n").replace(/( (\n))|( $)/gi,"$2").split("\n"))}return e}var ca,T=g.extend,da=g.inArray,W=g.type,$=g.isFunction,Aa=g.isPlainObject,C=Z.PI,Qa=Z.round,Ua=Z.abs,M=Z.sin,G=Z.cos,Ta=Z.atan2,pa=Ma.prototype.slice,
S={},Y={dataCache:{},propCache:{},imageCache:{}},ja={rotate:0,scaleX:1,scaleY:1,translateX:0,translateY:0,masks:[]},Q={},Na="mousedown mousemove mouseup mouseover mouseout touchstart touchmove touchend".split(" "),U={events:{},eventHooks:{},future:{}};ha.baseDefaults={align:"center",arrowAngle:90,arrowRadius:0,autosave:B,baseline:"middle",bringToFront:w,ccw:w,closed:w,compositing:"source-over",concavity:0,cornerRadius:0,count:1,cropFromCenter:B,crossOrigin:"",cursors:k,disableEvents:w,draggable:w,
dragGroups:k,groups:k,data:k,dx:k,dy:k,end:360,eventX:k,eventY:k,fillStyle:"transparent",fontStyle:"normal",fontSize:"12pt",fontFamily:"sans-serif",fromCenter:B,height:k,imageSmoothing:B,inDegrees:B,intangible:w,index:k,letterSpacing:k,lineHeight:1,layer:w,mask:w,maxWidth:k,miterLimit:10,name:k,opacity:1,r1:k,r2:k,radius:0,repeat:"repeat",respectAlign:w,rotate:0,rounded:w,scale:1,scaleX:1,scaleY:1,shadowBlur:0,shadowColor:"transparent",shadowStroke:w,shadowX:0,shadowY:0,sHeight:k,sides:0,source:"",
spread:0,start:0,strokeCap:"butt",strokeDash:k,strokeDashOffset:0,strokeJoin:"miter",strokeStyle:"transparent",strokeWidth:1,sWidth:k,sx:k,sy:k,text:"",translate:0,translateX:0,translateY:0,type:k,visible:B,width:k,x:0,y:0};ca=new ha;ga.prototype=ca;U.extend=function(d){d.name&&(d.props&&T(ca,d.props),g.fn[d.name]=function a(b){var e,f,h,p;for(f=0;f<this.length;f+=1)if(e=this[f],h=H(e))p=L(e,b,a),p=new J(p),O(e,h,p),d.fn.call(e,h,p);return this},d.type&&(S.drawings[d.type]=d.name));return g.fn[d.name]};
g.fn.getEventHooks=function(){var d;d={};0!==this.length&&(d=this[0],d=I(d),d=d.eventHooks);return d};g.fn.setEventHooks=function(d){var c,a;for(c=0;c<this.length;c+=1)g(this[c]),a=I(this[c]),T(a.eventHooks,d);return this};g.fn.getLayers=function(d){var c,a,b,e,f=[];if(0!==this.length)if(c=this[0],a=I(c),a=a.layers,$(d))for(e=0;e<a.length;e+=1)b=a[e],d.call(c,b)&&f.push(b);else f=a;return f};g.fn.getLayer=function(d){var c,a,b,e;if(0!==this.length)if(c=this[0],a=I(c),c=a.layers,e=W(d),d&&d._layerAdded)b=
d;else if("number"===e)0>d&&(d=c.length+d),b=c[d];else if("regexp"===e)for(a=0;a<c.length;a+=1){if(ea(c[a].name)&&c[a].name.match(d)){b=c[a];break}}else b=a.layer.names[d];return b};g.fn.getLayerGroup=function(d){var c,a,b,e=W(d);if(0!==this.length)if(c=this[0],"array"===e)b=d;else if("regexp"===e)for(a in c=I(c),c=c.layer.groups,c){if(a.match(d)){b=c[a];break}}else c=I(c),b=c.layer.groups[d];return b};g.fn.getLayerIndex=function(d){var c=this.getLayers();d=this.getLayer(d);return da(d,c)};g.fn.setLayer=
function(d,c){var a,b,e,f,h,p,m;for(b=0;b<this.length;b+=1)if(a=g(this[b]),e=I(this[b]),f=g(this[b]).getLayer(d)){ka(a,e,f,c);la(a,e,f,c);ia(c);for(h in c)c.hasOwnProperty(h)&&(p=c[h],m=W(p),"object"===m&&Aa(p)?(f[h]=T({},p),ia(f[h])):"array"===m?f[h]=p.slice(0):"string"===m?0===p.indexOf("+=")?f[h]+=X(p.substr(2)):0===p.indexOf("-=")?f[h]-=X(p.substr(2)):isNaN(p)?f[h]=p:f[h]=X(p):f[h]=p);wa(a,e,f);ya(a,e,f);g.isEmptyObject(c)===w&&K(a,e,f,"change",c)}return this};g.fn.setLayers=function(d,c){var a,
b,e,f;for(b=0;b<this.length;b+=1)for(a=g(this[b]),e=a.getLayers(c),f=0;f<e.length;f+=1)a.setLayer(e[f],d);return this};g.fn.setLayerGroup=function(d,c){var a,b,e,f;for(b=0;b<this.length;b+=1)if(a=g(this[b]),e=a.getLayerGroup(d))for(f=0;f<e.length;f+=1)a.setLayer(e[f],c);return this};g.fn.moveLayer=function(d,c){var a,b,e,f,h;for(b=0;b<this.length;b+=1)if(a=g(this[b]),e=I(this[b]),f=e.layers,h=a.getLayer(d))h.index=da(h,f),f.splice(h.index,1),f.splice(c,0,h),0>c&&(c=f.length+c),h.index=c,K(a,e,h,"move");
return this};g.fn.removeLayer=function(d){var c,a,b,e,f;for(a=0;a<this.length;a+=1)if(c=g(this[a]),b=I(this[a]),e=c.getLayers(),f=c.getLayer(d))f.index=da(f,e),e.splice(f.index,1),ka(c,b,f,{name:k}),la(c,b,f,{groups:k}),K(c,b,f,"remove");return this};g.fn.removeLayers=function(d){var c,a,b,e,f,h;for(a=0;a<this.length;a+=1){c=g(this[a]);b=I(this[a]);e=c.getLayers(d);for(h=0;h<e.length;h+=1)f=e[h],c.removeLayer(f),h-=1;b.layer.names={};b.layer.groups={}}return this};g.fn.removeLayerGroup=function(d){var c,
a,b,e;if(d!==s)for(a=0;a<this.length;a+=1)if(c=g(this[a]),I(this[a]),c.getLayers(),b=c.getLayerGroup(d))for(b=b.slice(0),e=0;e<b.length;e+=1)c.removeLayer(b[e]);return this};g.fn.addLayerToGroup=function(d,c){var a,b,e,f=[c];for(b=0;b<this.length;b+=1)a=g(this[b]),e=a.getLayer(d),e.groups&&(f=e.groups.slice(0),-1===da(c,e.groups)&&f.push(c)),a.setLayer(e,{groups:f});return this};g.fn.removeLayerFromGroup=function(d,c){var a,b,e,f=[],h;for(b=0;b<this.length;b+=1)a=g(this[b]),e=a.getLayer(d),e.groups&&
(h=da(c,e.groups),-1!==h&&(f=e.groups.slice(0),f.splice(h,1),a.setLayer(e,{groups:f})));return this};Q.cursors=["grab","grabbing","zoom-in","zoom-out"];Q.prefix=function(){var d=getComputedStyle(ra.documentElement,"");return"-"+(pa.call(d).join("").match(/-(moz|webkit|ms)-/)||""===d.OLink&&["","o"])[1]+"-"}();g.fn.triggerLayerEvent=function(d,c){var a,b,e;for(b=0;b<this.length;b+=1)a=g(this[b]),e=I(this[b]),(d=a.getLayer(d))&&K(a,e,d,c);return this};g.fn.drawLayer=function(d){var c,a,b;for(c=0;c<
this.length;c+=1)b=g(this[c]),(a=H(this[c]))&&(a=b.getLayer(d))&&a.visible&&a._method&&(a._next=k,a._method.call(b,a));return this};g.fn.drawLayers=function(d){var c,a,b=d||{},e,f,h,p,m,z,q,D;(p=b.index)||(p=0);for(c=0;c<this.length;c+=1)if(d=g(this[c]),a=H(this[c])){m=I(this[c]);b.clear!==w&&(h=this[c],a.clearRect(0,0,h.width,h.height));a=m.layers;for(h=p;h<a.length;h+=1)if(e=a[h],e.index=h,b.resetFire&&(e._fired=w),z=d,q=e,f=h+1,q&&q.visible&&q._method&&(q._next=f?f:k,q._method.call(z,q)),e._masks=
m.transforms.masks.slice(0),e._method===g.fn.drawImage&&e.visible){D=!0;break}if(D)break;e=m;var r=f=q=z=void 0;z=k;for(q=e.intersecting.length-1;0<=q;q-=1)if(z=e.intersecting[q],z._masks){for(r=z._masks.length-1;0<=r;r-=1)if(f=z._masks[r],!f.intersects){z.intersects=w;break}if(z.intersects&&!z.intangible)break}z&&z.intangible&&(z=k);e=z;z=m.event;q=z.type;if(m.drag.layer){f=d;var r=m,y=q,A=void 0,u=void 0,t=void 0,l=t=void 0,n=void 0,t=A=A=t=void 0,t=r.drag,l=(u=t.layer)&&u.dragGroups||[],A=r.layers;
if("mousemove"===y||"touchmove"===y){if(t.dragging||(t.dragging=B,u.dragging=B,u.bringToFront&&(A.splice(u.index,1),u.index=A.push(u)),u._startX=u.translateX,u._startY=u.translateY,u._endX=u._eventX,u._endY=u._eventY,K(f,r,u,"dragstart")),t.dragging)for(A=u._eventX-(u._endX-u._startX),t=u._eventY-(u._endY-u._startY),u.dx=A-u.translateX,u.dy=t-u.translateY,u.translateX=A,u.translateY=t,K(f,r,u,"drag"),A=0;A<l.length;A+=1)if(t=l[A],n=r.layer.groups[t],u.groups&&n)for(t=0;t<n.length;t+=1)n[t]!==u&&(n[t].x+=
u.dx,n[t].y+=u.dy)}else if("mouseup"===y||"touchend"===y)t.dragging&&(u.dragging=w,t.dragging=w,K(f,r,u,"dragstop")),r.drag={}}f=m.lastIntersected;f===k||e===f||!f._hovered||f._fired||m.drag.dragging||(m.lastIntersected=k,f._fired=B,f._hovered=w,K(d,m,f,"mouseout"),d.css({cursor:m.cursor}));e&&(e[q]||S.mouseEvents[q]&&(q=S.mouseEvents[q]),e._event&&e.intersects&&(m.lastIntersected=e,!(e.mouseover||e.mouseout||e.cursors)||m.drag.dragging||e._hovered||e._fired||(e._fired=B,e._hovered=B,K(d,m,e,"mouseover")),
e._fired||(e._fired=B,z.type=k,K(d,m,e,q)),!e.draggable||e.disableEvents||"mousedown"!==q&&"touchstart"!==q||(m.drag.layer=e)));e!==k||m.drag.dragging||d.css({cursor:m.cursor});h===a.length&&(m.intersecting.length=0,m.transforms=fa(ja),m.savedTransforms.length=0)}return this};g.fn.addLayer=function(d){var c,a;for(c=0;c<this.length;c+=1)(a=H(this[c]))&&L(this[c],T(d,{layer:!0}));return this};Q.props=["width","height","opacity","lineHeight"];Q.propsObj={};g.fn.animateLayer=function(){function d(a,b,
c){return function(){var d,e;for(e=0;e<Q.props.length;e+=1)d=Q.props[e],c[d]=c["_"+d];for(var h in c)c.hasOwnProperty(h)&&-1!==h.indexOf(".")&&delete c[h];b.animating&&b.animated!==c||a.drawLayers();c._animating=w;b.animating=w;b.animated=k;f[4]&&f[4].call(a[0],c);K(a,b,c,"animateend")}}function c(a,b,c){return function(d,e){var h,p,u=!1;"_"===e.prop[0]&&(u=!0,e.prop=e.prop.replace("_",""),c[e.prop]=c["_"+e.prop]);-1!==e.prop.indexOf(".")&&(h=e.prop.split("."),p=h[0],h=h[1],c[p]&&(c[p][h]=e.now));
c._pos!==e.pos&&(c._pos=e.pos,c._animating||b.animating||(c._animating=B,b.animating=B,b.animated=c),b.animating&&b.animated!==c||a.drawLayers());f[5]&&f[5].call(a[0],d,e,c);K(a,b,c,"animate",e);u&&(e.prop="_"+e.prop)}}var a,b,e,f=pa.call(arguments,0),h,p;"object"===W(f[2])?(f.splice(2,0,f[2].duration||k),f.splice(3,0,f[3].easing||k),f.splice(4,0,f[4].complete||k),f.splice(5,0,f[5].step||k)):(f[2]===s?(f.splice(2,0,k),f.splice(3,0,k),f.splice(4,0,k)):$(f[2])&&(f.splice(2,0,k),f.splice(3,0,k)),f[3]===
s?(f[3]=k,f.splice(4,0,k)):$(f[3])&&f.splice(3,0,k));for(b=0;b<this.length;b+=1)if(a=g(this[b]),e=H(this[b]))e=I(this[b]),(h=a.getLayer(f[0]))&&h._method!==g.fn.draw&&(p=T({},f[1]),p=Oa(this[b],h,p),za(p,B),za(h),h.style=Q.propsObj,g(h).animate(p,{duration:f[2],easing:g.easing[f[3]]?f[3]:k,complete:d(a,e,h),step:c(a,e,h)}),K(a,e,h,"animatestart"));return this};g.fn.animateLayerGroup=function(d){var c,a,b=pa.call(arguments,0),e,f;for(a=0;a<this.length;a+=1)if(c=g(this[a]),e=c.getLayerGroup(d))for(f=
0;f<e.length;f+=1)b[0]=e[f],c.animateLayer.apply(c,b);return this};g.fn.delayLayer=function(d,c){var a,b,e,f;c=c||0;for(b=0;b<this.length;b+=1)if(a=g(this[b]),e=I(this[b]),f=a.getLayer(d))g(f).delay(c),K(a,e,f,"delay");return this};g.fn.delayLayerGroup=function(d,c){var a,b,e,f,h;c=c||0;for(b=0;b<this.length;b+=1)if(a=g(this[b]),e=a.getLayerGroup(d))for(h=0;h<e.length;h+=1)f=e[h],a.delayLayer(f,c);return this};g.fn.stopLayer=function(d,c){var a,b,e,f;for(b=0;b<this.length;b+=1)if(a=g(this[b]),e=I(this[b]),
f=a.getLayer(d))g(f).stop(c),K(a,e,f,"stop");return this};g.fn.stopLayerGroup=function(d,c){var a,b,e,f,h;for(b=0;b<this.length;b+=1)if(a=g(this[b]),e=a.getLayerGroup(d))for(h=0;h<e.length;h+=1)f=e[h],a.stopLayer(f,c);return this};(function(d){var c;for(c=0;c<d.length;c+=1)g.fx.step[d[c]]=Pa})("color backgroundColor borderColor borderTopColor borderRightColor borderBottomColor borderLeftColor fillStyle outlineColor strokeStyle shadowColor".split(" "));S.touchEvents={mousedown:"touchstart",mouseup:"touchend",
mousemove:"touchmove"};S.mouseEvents={touchstart:"mousedown",touchend:"mouseup",touchmove:"mousemove"};(function(d){var c;for(c=0;c<d.length;c+=1)Sa(d[c])})("click dblclick mousedown mouseup mousemove mouseover mouseout touchstart touchmove touchend".split(" "));S.drawings={arc:"drawArc",bezier:"drawBezier",ellipse:"drawEllipse","function":"draw",image:"drawImage",line:"drawLine",path:"drawPath",polygon:"drawPolygon",slice:"drawSlice",quadratic:"drawQuadratic",rectangle:"drawRect",text:"drawText",
vector:"drawVector",save:"saveCanvas",restore:"restoreCanvas",rotate:"rotateCanvas",scale:"scaleCanvas",translate:"translateCanvas"};g.fn.draw=function c(a){var b,e,f=new J(a),h;if(S.drawings[f.type]&&"function"!==f.type)this[S.drawings[f.type]](a);else for(b=0;b<this.length;b+=1)if(g(this[b]),e=H(this[b]))h=L(this[b],a,c),f=new J(h),h.visible&&f.fn&&f.fn.call(this[b],e,f);return this};g.fn.saveCanvas=function a(b){var e,f,h,p,m;for(e=0;e<this.length;e+=1)if(f=H(this[e]))for(p=I(this[e]),h=L(this[e],
b,a),h=new J(h),m=0;m<h.count;m+=1)ta(f,p);return this};g.fn.restoreCanvas=function b(e){var f,h,p,m,g;for(f=0;f<this.length;f+=1)if(h=H(this[f]))for(m=I(this[f]),p=L(this[f],e,b),p=new J(p),g=0;g<p.count;g+=1){var q=h,k=m;0===k.savedTransforms.length?k.transforms=fa(ja):(q.restore(),k.transforms=k.savedTransforms.pop())}return this};g.fn.drawRect=function e(f){var h,p,m,g,q,k,r,y,A;for(h=0;h<this.length;h+=1)if(p=H(this[h]))g=L(this[h],f,e),m=new J(g),g.visible&&(O(this[h],p,m),N(this[h],p,m,m.width,
m.height),p.beginPath(),m.width&&m.height&&(g=m.x-m.width/2,q=m.y-m.height/2,(y=Ua(m.cornerRadius))?(k=m.x+m.width/2,r=m.y+m.height/2,0>m.width&&(A=g,g=k,k=A),0>m.height&&(A=q,q=r,r=A),0>k-g-2*y&&(y=(k-g)/2),0>r-q-2*y&&(y=(r-q)/2),p.moveTo(g+y,q),p.lineTo(k-y,q),p.arc(k-y,q+y,y,3*C/2,2*C,w),p.lineTo(k,r-y),p.arc(k-y,r-y,y,0,C/2,w),p.lineTo(g+y,r),p.arc(g+y,r-y,y,C/2,C,w),p.lineTo(g,q+y),p.arc(g+y,q+y,y,C,3*C/2,w),m.closed=B):p.rect(g,q,m.width,m.height)),P(this[h],p,m),R(this[h],p,m));return this};
g.fn.drawArc=function f(h){var g,m,k,q;for(g=0;g<this.length;g+=1)if(m=H(this[g]))q=L(this[g],h,f),k=new J(q),q.visible&&(O(this[g],m,k),N(this[g],m,k,2*k.radius),m.beginPath(),Da(this[g],m,k,k),P(this[g],m,k),R(this[g],m,k));return this};g.fn.drawEllipse=function h(g){var m,k,q,D,r;for(m=0;m<this.length;m+=1)if(k=H(this[m]))D=L(this[m],g,h),q=new J(D),D.visible&&(O(this[m],k,q),N(this[m],k,q,q.width,q.height),D=4/3*q.width,r=q.height,k.beginPath(),k.moveTo(q.x,q.y-r/2),k.bezierCurveTo(q.x-D/2,q.y-
r/2,q.x-D/2,q.y+r/2,q.x,q.y+r/2),k.bezierCurveTo(q.x+D/2,q.y+r/2,q.x+D/2,q.y-r/2,q.x,q.y-r/2),P(this[m],k,q),q.closed=B,R(this[m],k,q));return this};g.fn.drawPolygon=function p(g){var k,q,D,r,y,A,u,t,l,n;for(k=0;k<this.length;k+=1)if(q=H(this[k]))if(r=L(this[k],g,p),D=new J(r),r.visible){O(this[k],q,D);N(this[k],q,D,2*D.radius);y=2*C/D.sides;A=y/2;r=A+C/2;u=D.radius*G(A);q.beginPath();for(n=0;n<D.sides;n+=1)t=D.x+D.radius*G(r),l=D.y+D.radius*M(r),q.lineTo(t,l),D.concavity&&(t=D.x+(u+-u*D.concavity)*
G(r+A),l=D.y+(u+-u*D.concavity)*M(r+A),q.lineTo(t,l)),r+=y;P(this[k],q,D);D.closed=B;R(this[k],q,D)}return this};g.fn.drawSlice=function m(k){var q,D,r,y,A;for(q=0;q<this.length;q+=1)if(g(this[q]),D=H(this[q]))y=L(this[q],k,m),r=new J(y),y.visible&&(O(this[q],D,r),N(this[q],D,r,2*r.radius),r.start*=r._toRad,r.end*=r._toRad,r.start-=C/2,r.end-=C/2,r.start=Ca(r.start),r.end=Ca(r.end),r.end<r.start&&(r.end+=2*C),A=(r.start+r.end)/2,y=r.radius*r.spread*G(A),A=r.radius*r.spread*M(A),r.x+=y,r.y+=A,D.beginPath(),
D.arc(r.x,r.y,r.radius,r.start,r.end,r.ccw),D.lineTo(r.x,r.y),P(this[q],D,r),r.closed=B,R(this[q],D,r));return this};g.fn.drawLine=function z(g){var k,r,y,A;for(k=0;k<this.length;k+=1)if(r=H(this[k]))A=L(this[k],g,z),y=new J(A),A.visible&&(O(this[k],r,y),N(this[k],r,y),r.beginPath(),Fa(this[k],r,y,y),P(this[k],r,y),R(this[k],r,y));return this};g.fn.drawQuadratic=function q(k){var g,y,A,u;for(g=0;g<this.length;g+=1)if(y=H(this[g]))u=L(this[g],k,q),A=new J(u),u.visible&&(O(this[g],y,A),N(this[g],y,
A),y.beginPath(),Ga(this[g],y,A,A),P(this[g],y,A),R(this[g],y,A));return this};g.fn.drawBezier=function D(g){var k,A,u,t;for(k=0;k<this.length;k+=1)if(A=H(this[k]))t=L(this[k],g,D),u=new J(t),t.visible&&(O(this[k],A,u),N(this[k],A,u),A.beginPath(),Ha(this[k],A,u,u),P(this[k],A,u),R(this[k],A,u));return this};g.fn.drawVector=function r(k){var g,u,t,l;for(g=0;g<this.length;g+=1)if(u=H(this[g]))l=L(this[g],k,r),t=new J(l),l.visible&&(O(this[g],u,t),N(this[g],u,t),u.beginPath(),Ka(this[g],u,t,t),P(this[g],
u,t),R(this[g],u,t));return this};g.fn.drawPath=function y(g){var k,t,l,n,x;for(k=0;k<this.length;k+=1)if(t=H(this[k]))if(n=L(this[k],g,y),l=new J(n),n.visible){O(this[k],t,l);N(this[k],t,l);t.beginPath();for(n=1;B;)if(x=l["p"+n],x!==s)x=new J(x),"line"===x.type?Fa(this[k],t,l,x):"quadratic"===x.type?Ga(this[k],t,l,x):"bezier"===x.type?Ha(this[k],t,l,x):"vector"===x.type?Ka(this[k],t,l,x):"arc"===x.type&&Da(this[k],t,l,x),n+=1;else break;P(this[k],t,l);R(this[k],t,l)}return this};g.fn.drawText=function A(u){var t,
l,n,x,V,v,E,s,B,w;for(t=0;t<this.length;t+=1)if(g(this[t]),l=H(this[t]))if(x=L(this[t],u,A),n=new J(x),x.visible){O(this[t],l,n);l.textBaseline=n.baseline;l.textAlign=n.align;na(this[t],l,n);V=n.maxWidth!==k?La(l,n):n.text.toString().split("\n");oa(this[t],l,n,V);x&&(x.width=n.width,x.height=n.height);N(this[t],l,n,n.width,n.height);E=n.x;"left"===n.align?n.respectAlign?n.x+=n.width/2:E-=n.width/2:"right"===n.align&&(n.respectAlign?n.x-=n.width/2:E+=n.width/2);if(n.radius)for(E=X(n.fontSize),n.letterSpacing===
k&&(n.letterSpacing=E/500),v=0;v<V.length;v+=1){l.save();l.translate(n.x,n.y);x=V[v];s=x.length;l.rotate(-(C*n.letterSpacing*(s-1))/2);for(w=0;w<s;w+=1)B=x[w],0!==w&&l.rotate(C*n.letterSpacing),l.save(),l.translate(0,-n.radius),l.fillText(B,0,0),l.restore();n.radius-=E;n.letterSpacing+=E/(1E3*C);l.restore()}else for(v=0;v<V.length;v+=1)x=V[v],s=n.y+v*n.height/V.length-(V.length-1)*n.height/V.length/2,l.shadowColor=n.shadowColor,l.fillText(x,E,s),"transparent"!==n.fillStyle&&(l.shadowColor="transparent"),
0!==n.strokeWidth&&l.strokeText(x,E,s);s=0;"top"===n.baseline?s+=n.height/2:"bottom"===n.baseline&&(s-=n.height/2);n._event&&(l.beginPath(),l.rect(n.x-n.width/2,n.y-n.height/2+s,n.width,n.height),P(this[t],l,n),l.closePath());n._transformed&&l.restore()}Y.propCache=n;return this};g.fn.measureText=function(k){var g,t;g=this.getLayer(k);if(!g||g&&!g._layerAdded)g=new J(k);if(k=H(this[0]))na(this[0],k,g),t=La(k,g),oa(this[0],k,g,t);return g};g.fn.drawImage=function u(t){function l(n,u,t,l,v){return function(){var x=
g(n);O(n,u,l);l.width===k&&l.sWidth===k&&(l.width=l.sWidth=F.width);l.height===k&&l.sHeight===k&&(l.height=l.sHeight=F.height);v&&(v.width=l.width,v.height=l.height);l.sWidth!==k&&l.sHeight!==k&&l.sx!==k&&l.sy!==k?(l.width===k&&(l.width=l.sWidth),l.height===k&&(l.height=l.sHeight),l.cropFromCenter&&(l.sx+=l.sWidth/2,l.sy+=l.sHeight/2),0>l.sy-l.sHeight/2&&(l.sy=l.sHeight/2),l.sy+l.sHeight/2>F.height&&(l.sy=F.height-l.sHeight/2),0>l.sx-l.sWidth/2&&(l.sx=l.sWidth/2),l.sx+l.sWidth/2>F.width&&(l.sx=F.width-
l.sWidth/2),N(n,u,l,l.width,l.height),u.drawImage(F,l.sx-l.sWidth/2,l.sy-l.sHeight/2,l.sWidth,l.sHeight,l.x-l.width/2,l.y-l.height/2,l.width,l.height)):(N(n,u,l,l.width,l.height),u.drawImage(F,l.x-l.width/2,l.y-l.height/2,l.width,l.height));u.beginPath();u.rect(l.x-l.width/2,l.y-l.height/2,l.width,l.height);P(n,u,l);u.closePath();l._transformed&&u.restore();va(u,t,v);K(x,t,v,"load");v._masks=t.transforms.masks.slice(0);l._next&&x.drawLayers({clear:w,resetFire:B,index:l._next})}}var n,x,s,v,E,C,F,
qa,G,M=Y.imageCache;for(x=0;x<this.length;x+=1)if(n=this[x],s=H(this[x]))v=I(this[x]),C=L(this[x],t,u),E=new J(C),C.visible&&(G=E.source,qa=G.getContext,G.src||qa?F=G:G&&(M[G]&&M[G].complete?F=M[G]:(F=new sa,G.match(/^data:/i)||(F.crossOrigin=E.crossOrigin),F.src=G,M[G]=F)),F&&(F.complete||qa?l(n,s,v,E,C)():(F.onload=l(n,s,v,E,C),F.src=F.src)));return this};g.fn.createPattern=function(u){function t(){v=n.createPattern(s,x.repeat);x.load&&x.load.call(l[0],v)}var l=this,n,x,s,v,E;(n=H(l[0]))?(x=T({},
ca,u),E=x.source,$(E)?(s=g("<canvas />")[0],s.width=x.width,s.height=x.height,u=H(s),E.call(s,u),t()):(u=E.getContext,E.src||u?s=E:(s=new sa,s.crossOrigin=x.crossOrigin,s.src=E),s.complete||u?t():(s.onload=t(),s.src=s.src))):v=k;return v};g.fn.createGradient=function(g){var t,l=[],n,x,B,v,E,w,F;g=new J(g);if(t=H(this[0])){g.x1=g.x1||0;g.y1=g.y1||0;g.x2=g.x2||0;g.y2=g.y2||0;t=g.r1!==k&&g.r2!==k?t.createRadialGradient(g.x1,g.y1,g.r1,g.x2,g.y2,g.r2):t.createLinearGradient(g.x1,g.y1,g.x2,g.y2);for(v=
1;g["c"+v]!==s;v+=1)g["s"+v]!==s?l.push(g["s"+v]):l.push(k);n=l.length;l[0]===k&&(l[0]=0);l[n-1]===k&&(l[n-1]=1);for(v=0;v<n;v+=1){if(l[v]!==k){w=1;F=0;x=l[v];for(E=v+1;E<n;E+=1)if(l[E]!==k){B=l[E];break}else w+=1;x>B&&(l[E]=l[v])}else l[v]===k&&(F+=1,l[v]=x+(B-x)/w*F);t.addColorStop(l[v],g["c"+(v+1)])}}else t=k;return t};g.fn.setPixels=function t(g){var n,s,B,v,E,w,F,C,G;for(s=0;s<this.length;s+=1)if(n=this[s],B=H(n)){v=L(n,g,t);v=new J(v);N(this[s],B,v,v.width,v.height);if(v.width===k||v.height===
k)v.width=n.width,v.height=n.height,v.x=v.width/2,v.y=v.height/2;if(0!==v.width&&0!==v.height){w=B.getImageData(v.x-v.width/2,v.y-v.height/2,v.width,v.height);F=w.data;G=F.length;if(v.each)for(C=0;C<G;C+=4)E={r:F[C],g:F[C+1],b:F[C+2],a:F[C+3]},v.each.call(n,E,v),F[C]=E.r,F[C+1]=E.g,F[C+2]=E.b,F[C+3]=E.a;B.putImageData(w,v.x-v.width/2,v.y-v.height/2);B.restore()}}return this};g.fn.getCanvasImage=function(g,l){var n,x=k;0!==this.length&&(n=this[0],n.toDataURL&&(l===s&&(l=1),x=n.toDataURL("image/"+g,
l)));return x};g.fn.detectPixelRatio=function(k){var l,n,s,w,v,C,G;for(n=0;n<this.length;n+=1)l=this[n],g(this[n]),s=H(l),G=I(this[n]),G.scaled||(w=window.devicePixelRatio||1,v=s.webkitBackingStorePixelRatio||s.mozBackingStorePixelRatio||s.msBackingStorePixelRatio||s.oBackingStorePixelRatio||s.backingStorePixelRatio||1,w/=v,1!==w&&(v=l.width,C=l.height,l.width=v*w,l.height=C*w,l.style.width=v+"px",l.style.height=C+"px",s.scale(w,w)),G.pixelRatio=w,G.scaled=B,k&&k.call(l,w));return this};U.clearCache=
function(){for(var g in Y)Y.hasOwnProperty(g)&&(Y[g]={})};g.support.canvas=g("<canvas />")[0].getContext!==s;T(U,{defaults:ca,setGlobalProps:O,transformShape:N,detectEvents:P,closePath:R,setCanvasFont:na,measureText:oa});g.jCanvas=U;g.jCanvasLayer=ga})(jQuery,document,Image,Array,Math,parseFloat,!0,!1,null);

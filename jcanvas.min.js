/*
 jCanvas v13.04.24
 Copyright 2013 Caleb Evans
 Released under the MIT license
*/
(function(d,ca,ia,T,ja,q,B,g,z){function F(c){P(this,c);return this}function L(c){c?P(F.prototype,c):L.prefs=F.prototype=P({},Z);return this}function $(c){return"string"===typeof c}function U(c){return"function"===typeof c}function E(c){return c&&c.getContext?c.getContext("2d"):g}function N(c,a){c.fillStyle=a.fillStyle;c.strokeStyle=a.strokeStyle;c.lineWidth=a.strokeWidth;a.rounded?(c.lineCap="round",c.lineJoin="round"):(c.lineCap=a.strokeCap,c.lineJoin=a.strokeJoin,c.miterLimit=a.miterLimit);c.shadowOffsetX=
a.shadowX;c.shadowOffsetY=a.shadowY;c.shadowBlur=a.shadowBlur;c.shadowColor=a.shadowColor;c.globalAlpha=a.opacity;c.globalCompositeOperation=a.compositing;a.imageSmoothing&&(c.webkitimageSmoothingEnabled=c.mozimageSmoothingEnabled=a.imageSmoothing)}function ka(c,a,b){b.mask&&(b.autosave&&(c.save(),a.savedTransforms=P({},a.transforms),a.transforms.masks+=1,a.transforms.withinMask=c.isPointInPath(a.event.x,a.event.y)?q:B),c.clip())}function da(c,a,b){b.layer&&(b._args.withinMask=a.transforms.withinMask===
q||a.transforms.withinMask===g?q:B)}function Q(c,a,b){b.closed&&a.closePath();a.fill();"transparent"!==b.fillStyle&&(a.shadowColor="transparent");0!==b.strokeWidth&&a.stroke();b.closed||a.closePath();b._transformed&&a.restore();if(b.mask||b.layer)c=K(c),ka(a,c,b),da(a,c,b)}function M(c,a,b,f){a._toRad=a.inDegrees?I/180:1;a._transformed=q;c.save();f===z&&(f=b);!a.fromCenter&&!a._centered&&(a.x+=b/2,a.y+=f/2,a._centered=q);a.rotate&&(a._toRad=a.inDegrees?I/180:1,c.translate(a.x,a.y),c.rotate(a.rotate*
a._toRad),c.translate(-a.x,-a.y));if(1!==a.scale||1!==a.scaleX||1!==a.scaleY)1!==a.scale&&(a.scaleX=a.scaleY=a.scale),c.translate(a.x,a.y),c.scale(a.scaleX,a.scaleY),c.translate(-a.x,-a.y);if(a.translate||a.translateX||a.translateY)a.translate&&(a.translateX=a.translateY=a.translate),c.translate(a.translateX,a.translateY)}function K(c){var a;H._canvas===c&&H._data?a=H._data:(a=d.data(c,"jCanvas"),a||(a={canvas:c,layers:[],layer:{names:{},groups:{}},intersects:[],drag:{},event:{},events:{},transforms:{rotate:0,
scaleX:1,scaleY:1,translateX:0,translateY:0,masks:0,withinMask:g},animating:B,animated:g},a.savedTransforms=P({},a.transforms),d.data(c,"jCanvas",a)),H._canvas=c,H._data=a);return a}function la(c,a,b){for(var f in L.events)if(L.events.hasOwnProperty(f)){var h=c,e=a,d=b,g=f;d[g]&&(g=ea(g),L.events[g](h,e),d._event=q)}}function ma(c,a,b){var f,h,e;if(b.draggable||b.dragGroupWithLayer||b.cursor){f=["mousedown","mousemove","mouseup"];for(e=0;e<f.length;e+=1)h=ea(f[e]),L.events[h](c,a);a.events.mouseoutdrag||
(c.bind("mouseout.jCanvas",function(){a.drag={};c.drawLayers()}),a.events.mouseoutdrag=q);b._event=q}}function na(c,a,b,f){c=a.layer.names;f?f.name!==z&&($(b.name)&&b.group!==f.group)&&delete c[b.name]:f=b;$(f.name)&&(c[f.name]=b)}function oa(c,a,b,f){c=a.layer.groups;var h;if(f){if(f.group!==z&&($(b.group)&&b.group!==f.group)&&(a=c[b.group]))for(h=0;h<a.length;h+=1)if(a[h]===b){a.splice(h,1);break}}else f=b;$(f.group)&&((a=c[f.group])||(a=c[f.group]=[]),a.push(b))}function pa(c,a,b){b&&b.visible&&
(b.method===d.fn.draw?b.fn.call(c[0],a):b.method&&b.method.call(c,b))}function J(c,a,b,f){var h,e={};a._args=b;a.canvas=c;if(a.draggable||e.group)a.layer=q,a.draggable=q;a.layer&&!a._layer&&(b=d(c),h=b.getLayers(),a.method=f?f:a.method?d.fn[a.method]:a.type?d.fn[qa[a.type]]:function(){},c=K(c),e=new F(a),na(b,c,e),oa(b,c,e),la(b,c,e),ma(b,c,e),e.layer=q,e._layer=q,e.index===z&&(e.index=h.length),h.splice(e.index,0,e));return e}function ra(c){var a;for(a=0;a<S.length;a+=1)c[S[a]]=c["_"+S[a]]}function sa(c,
a){var b;for(b=0;b<S.length;b+=1)c["_"+S[b]]=c[S[b]],fa[S[b]]=1,a&&delete c[S[b]]}function ta(c){var a,b,f=[],h=1;c.match(/^#?\w+$/i)&&("transparent"===c&&(c="rgba(0,0,0,0)"),b=ca.head,a=b.style.color,b.style.color=c,c=d.css(b,"color"),b.style.color=a);c.match(/^rgb/i)&&(f=c.match(/\d+/gi),c.match(/%/gi)&&(h=2.55),f[0]*=h,f[1]*=h,f[2]*=h,f[3]=f[3]!==z?ja(f[3]):1);return f}function za(c){var a=3,b;"object"!==typeof c.start&&(c.start=ta(c.start),c.end=ta(c.end));c.now=[];if(1!==c.start[3]||1!==c.end[3])a=
4;for(b=0;b<a;b+=1)c.now[b]=c.start[b]+(c.end[b]-c.start[b])*c.pos,3>b&&(c.now[b]=Aa(c.now[b]));1!==c.start[3]||1!==c.end[3]?c.now="rgba("+c.now.join(",")+")":(c.now.slice(0,3),c.now="rgb("+c.now.join(",")+")");c.elem.nodeName?c.elem.style[c.prop]=c.now:c.elem[c.prop]=c.now}function ea(c){"ontouchstart"in window&&ga[c]&&(c=ga[c]);return c}function R(c){L.events[c]=function(a,b){c=ea(c);var f="mouseover"===c||"mouseout"===c?"mousemove":c,h=b.event;b.events[f]||(a.bind(f+".jCanvas",function(b){h.x=
b.offsetX;h.y=b.offsetY;h.type=f;h.event=b;a.drawLayers({resetFire:q});b.preventDefault()}),b.events[f]=q)}}function O(c,a,b){var f,h,e,d;b=b._args;b._event&&(c=K(c),f=c.event,a=a.isPointInPath(f.x,f.y),h=c.transforms,b.eventX=b.mouseX=f.x,b.eventY=b.mouseY=f.y,b.event=f.event,d=c.transforms.rotate,f=b.eventX,e=b.eventY,0!==d?(b._eventX=f*V(-d)-e*W(-d),b._eventY=e*V(-d)+f*W(-d)):(b._eventX=f,b._eventY=e),b._eventX/=h.scaleX,b._eventY/=h.scaleY,!a&&(b._hovered&&!b._fired)&&(b._mousedout=q),a&&c.intersects.push(b))}
function ua(c){U(c)&&(c={method:d.fn.draw,fn:c});return c}function aa(c,a,b,f,h){a.save();a.beginPath();a.rect(f[0],h[0],f[1]-f[0],h[1]-h[0]);a.clip();M(a,b,0);a.beginPath()}function ba(c,a,b){b._event&&O(c,a,b);a.restore();Q(c,a,b)}function va(c,a){a.font?c.font=a.font:(isNaN(Number(a.fontSize))||(a.fontSize+="px"),c.font=a.fontStyle+" "+a.fontSize+" "+a.fontFamily)}function wa(c,a,b,f){var h,e=/\b(\d*\.?\d*)\w\w\b/gi,v;if(H.text===b.text&&H.font===b.font&&H.fontStyle===b.fontStyle&&H.fontSize===
b.fontSize&&H.fontFamily===b.fontFamily&&H.maxWidth===b.maxWidth&&H.lineHeight===b.lineHeight)b.width=H.width,b.height=H.height;else{b.width=a.measureText(f[0]).width;for(h=1;h<f.length;h+=1)v=a.measureText(f[h]).width,v>b.width&&(b.width=v);a=c.style.fontSize;if(b.font){if(h=b.font.match(e))c.style.fontSize=b.font.match(e)[0]}else c.style.fontSize=b.fontSize;b.height=ja(d.css(c,"fontSize"))*f.length*b.lineHeight;c.style.fontSize=a}}function xa(c,a){var b=a.text,f=a.maxWidth,h=b.split(" "),e=[],d=
"";if(c.measureText(b).width<f||1===h.length)e=[b];else{for(b=0;b<h.length;b+=1)c.measureText(d+h[b]).width>f&&(""!==d&&e.push(d),d=""),d+=h[b],b!==h.length-1&&(d+=" ");e.push(d)}return e=e.join("\n").replace(/( (\n))|( $)/gi,"$2").split("\n")}var Z,P=d.extend,X=d.inArray,Aa=T.round,I=T.PI,W=T.sin,V=T.cos,Ba=d.event.fix,ga,ha,qa,H={},S,fa;d.fn.jCanvas=L;L.events={};Z={align:"center",autosave:q,baseline:"middle",bringToFront:B,ccw:B,closed:B,compositing:"source-over",concavity:0,cornerRadius:0,cropFromCenter:q,
disableDrag:B,disableEvents:B,domain:g,draggable:B,group:null,data:{},each:g,end:360,fillStyle:"transparent",font:"",fontStyle:"normal",fontSize:"12pt",fontFamily:"sans-serif",fromCenter:q,fn:g,graph:"y",height:g,imageSmoothing:q,inDegrees:q,lineHeight:1,layer:!1,load:g,mask:B,maxWidth:g,miterLimit:10,name:null,opacity:1,projection:0,r1:g,r2:g,radius:0,range:g,repeat:"repeat",rotate:0,rounded:B,scale:1,scaleX:1,scaleY:1,shadowBlur:0,shadowColor:"transparent",shadowX:0,shadowY:0,sHeight:g,sides:0,
source:"",start:0,strokeCap:"butt",strokeJoin:"miter",strokeStyle:"transparent",strokeWidth:1,sWidth:g,sx:g,sy:g,text:"",translate:0,translateX:0,translateY:0,type:g,visible:q,width:g,x:0,y:0};L();L.extend=function(c){L.defaults=P(Z,c.props);L();c.name&&(d.fn[c.name]=function b(f){var h,e,d,g=new F(f);for(e=0;e<this.length;e+=1)if(h=this[e],d=E(h))f=J(h,g,f,b),N(d,g),c.fn.call(h,d,g);return this});return d.fn[c.name]};d.fn.getLayers=function(c){var a=this[0],b,f,h=[];if(a&&a.getContext)if(b=K(a).layers,
U(c))for(f=0;f<b.length;f+=1)c.call(a,b[f])&&h.push(b[f]);else h=b;return h};d.fn.getLayer=function(c){var a=this.getLayers(),b=d.type(c),f=K(this[0]),h;if(c&&c.layer)h=c;else if("number"===b)0>c&&(c=a.length+c),h=a[c];else if("regexp"===b)for(b=0;b<a.length;b+=1){if(a[b].name.match(c)){h=a[b];break}}else f=K(this[0]),h=f.layer.names[c];return h};d.fn.getLayerIndex=function(c){var a=this.getLayers();c=this.getLayer(c);return X(c,a)};d.fn.setLayer=function(c,a){var b,f,h,e;for(f=0;f<this.length;f+=
1)if(b=d(this[f]),h=K(this[f]),e=d(this[f]).getLayer(c))na(b,h,e,a),oa(b,h,e,a),P(e,a),la(b,h,e),ma(b,h,e);return this};d.fn.setLayers=function(c){var a,b,f,h;for(b=0;b<this.length;b+=1){a=d(this[b]);f=d(this[b]).getLayers();for(h=0;h<f.length;h+=1)a.setLayer(f[h],c)}return this};d.fn.moveLayer=function(c,a){var b,f,h;for(f=0;f<this.length;f+=1)if(b=d(this[f]),h=b.getLayers(),b=b.getLayer(c))b.index=X(b,h),h.splice(b.index,1),h.splice(a,0,b),0>a&&(a=h.length+a),b.index=a;return this};d.fn.removeLayer=
function(c){var a,b,f;for(b=0;b<this.length;b+=1)if(a=d(this[b]),f=a.getLayers(),a=a.getLayer(c))a.index=X(a,f),f.splice(a.index,1);return this};d.fn.removeLayers=function(){var c,a;for(a=0;a<this.length;a+=1)c=d(this[a]),c=c.getLayers(),c.length=0;return this};d.fn.getLayerGroup=function(c){var a=this.getLayers(),b=d.type(c),f=[];if("array"===b)return c;if("regexp"===b)for(b=0;b<a.length;b+=1)a[b].index=b,a[b].group.match(c)&&f.push(a[b]);else a=K(this[0]),f=a.layer.groups[c];return f};d.fn.setLayerGroup=
function(c,a){var b,f,h,e;for(f=0;f<this.length;f+=1)if(b=d(this[f]),h=b.getLayerGroup(c))for(e=0;e<h.length;e+=1)b.setLayer(h[e],a);return this};d.fn.removeLayerGroup=function(c){var a,b,f=d.type(c),h,e;if(c!==z)for(b=0;b<this.length;b+=1){a=d(this[b]);a=a.getLayers();for(e=0;e<a.length;e+=1)if(h=a[e],h.index=X(h,a),a[e].group===c||"regexp"===f&&a[e].group.match(c))a.splice(e,1),e-=1}return this};d.fn.drawLayer=function(c){var a,b,f,h;for(a=0;a<this.length;a+=1)f=d(this[a]),b=E(this[a]),h=f.getLayer(c),
pa(f,b,h);return this};d.fn.drawLayers=function(c){var a,b,f=c||{},h,e,v,G,t,C;f.index||(f.index=0);for(c=0;c<this.length;c+=1)if(a=d(this[c]),b=E(this[c])){G=K(this[c]);for(e=0;e<G.transforms.masks;e+=1)a.restoreCanvas();f.clear!==B&&a.clearCanvas();h=G.layers;for(v=f.index;v<h.length&&!(e=h[v],e.index=v,f.resetFire&&(e._fired=B),e._event=!e.disableEvents,pa(a,b,e),e._mousedout&&(e._mousedout=B,e._fired=q,e._hovered=B,e.mouseout&&e.mouseout.call(this[c],e),e.cursor&&e._cursor&&a.css({cursor:e._cursor})),
e.method===d.fn.drawImage&&e.visible);v+=1);for(e=0;e<G.transforms.masks;e+=1)a.restoreCanvas();e=G.intersects[G.intersects.length-1]||{};v=G.event;b=v.type;e[b]||ha[b]&&(b=ha[b]);C=e[b];t=G.drag;if(e._event&&e.withinMask===q){if((e.mouseover||e.mouseout||e.cursor)&&!e._hovered&&!e._fired)e._fired=q,e._hovered=q,e.mouseover&&e.mouseover.call(this[c],e),e.cursor&&(e._cursor=a.css("cursor"),a.css({cursor:e.cursor}));C&&!e._fired&&(e._fired=q,C.call(this[c],e),v.type=g);if(e.draggable&&!e.disableDrag&&
("mousedown"===b||"touchstart"===b)){e.bringToFront&&(h.splice(e.index,1),e.index=h.push(e));t.layer=e;t.dragging=q;if(t.layer.group&&t.layer.dragGroupWithLayer&&(a=G.layer.groups[t.layer.group]))for(v=0;v<a.length;v+=1)a[v]!==t.layer&&(a[v]._startX=a[v].x,a[v]._startY=a[v].y,a[v]._endX=e._eventX,a[v]._endY=e._eventY,a[v].bringToFront&&(a[v].index=X(a[v],h),h.splice(a[v].index,1),h.splice(-1,0,a[v]),a[v].index=h.length-2));t._startX=e._startX=e.x;t._startY=e._startY=e.y;t._endX=e._endX=e._eventX;
t._endY=e._endY=e._eventY;e.dragstart&&e.dragstart.call(this[c],e)}}if(t.layer){if(t.dragging&&("mouseup"===b||"touchend"===b))t.layer.dragstop&&t.layer.dragstop.call(this[c],t.layer),G.drag={};if(t.dragging&&("mousemove"===b||"touchmove"===b))if(t.layer.x=t.layer._eventX-(t._endX-t._startX),t.layer.y=t.layer._eventY-(t._endY-t._startY),t.layer.drag&&t.layer.drag.call(this[c],t.layer),t.layer.group&&t.layer.dragGroupWithLayer&&(a=G.layer.groups[t.layer.group]))for(v=0;v<a.length;v+=1)a[v]!==t.layer&&
(a[v].x=t.layer._eventX-(a[v]._endX-a[v]._startX),a[v].y=t.layer._eventY-(a[v]._endY-a[v]._startY))}G.intersects=[]}return this};d.fn.addLayer=function(c){var a,b,f;c=ua(c);f=new F(c);for(a=0;a<this.length;a+=1)if(b=E(this[a]))f.layer=q,c=J(this[a],f,c);return this};S=["width","height","opacity","lineHeight"];fa={};d.fn.animateLayer=function(){function c(a,b,c){return function(){ra(c);(!b.animating||b.animated===c)&&a.drawLayers();e[4]&&e[4].call(a[0],c);c._animating=B;b.animating=B;b.animated=g}}
function a(a,b,c){return function(f,h){ra(c);!c._animating&&!b.animating&&(c._animating=q,b.animating=q,b.animated=c);(!b.animating||b.animated===c)&&a.drawLayers();e[5]&&e[5].call(a[0],f,h,c)}}var b,f,h,e=[].slice.call(arguments,0),v,G;"object"===typeof e[0]&&!e[0].layer&&e.unshift(0);"object"===typeof e[2]?(e.splice(2,0,e[2].duration||g),e.splice(3,0,e[3].easing||g),e.splice(4,0,e[4].complete||g),e.splice(5,0,e[5].step||g)):(e[2]===z?(e.splice(2,0,g),e.splice(3,0,g),e.splice(4,0,g)):U(e[2])&&(e.splice(2,
0,g),e.splice(3,0,g)),e[3]===z?(e[3]=g,e.splice(4,0,g)):U(e[3])&&e.splice(3,0,g));for(f=0;f<this.length;f+=1)if(b=d(this[f]),h=E(this[f]))if(h=K(this[f]),(v=b.getLayer(e[0]))&&v.method!==d.fn.draw){G=P({},e[1]);var t=this[f],C=v,w=void 0;for(w in G)G.hasOwnProperty(w)&&U(G[w])&&(G[w]=G[w].call(t,C,w));sa(G,q);sa(v);v.style=fa;d(v).animate(G,{duration:e[2],easing:d.easing[e[3]]?e[3]:g,complete:c(b,h,v),step:a(b,h,v)})}return this};d.fn.animateLayerGroup=function(c){var a,b,f=[].slice.call(arguments,
0),h,e;for(b=0;b<this.length;b+=1){a=d(this[b]);h=a.getLayerGroup(c);for(e=0;e<h.length;e+=1)a.animateLayer.apply(a,[h[e]].concat(f.slice(1)))}};d.fn.delayLayer=function(c,a){var b,f;a=a||0;for(b=0;b<this.length;b+=1)f=d(this[b]).getLayer(c),d(f).delay(a);return this};d.fn.delayLayerGroup=function(c,a){var b,f,h,e;a=a||0;for(f=0;f<this.length;f+=1){b=d(this[f]);h=b.getLayerGroup(c);for(e=0;e<h.length;e+=1)b.delayLayer.call(b,h[e],a)}};d.fn.stopLayer=function(c,a){var b,f;for(b=0;b<this.length;b+=
1)f=d(this[b]).getLayer(c),d(f).stop(a);return this};d.fn.stopLayerGroup=function(c,a){var b,f,h,e;for(f=0;f<this.length;f+=1){b=d(this[f]);h=b.getLayerGroup(c);for(e=0;e<h.length;e+=1)b.stopLayer.call(b,h[e],a)}};var ya="color backgroundColor borderColor borderTopColor borderRightColor borderBottomColor borderLeftColor fillStyle outlineColor strokeStyle shadowColor".split(" "),Y;for(Y=0;Y<ya.length;Y+=1)d.fx.step[ya[Y]]=za;ga={mousedown:"touchstart",mouseup:"touchend",mousemove:"touchmove"};ha={touchstart:"mousedown",
touchend:"mouseup",touchmove:"mousemove"};R("click");R("dblclick");R("mousedown");R("mouseup");R("mousemove");R("mouseover");R("mouseout");R("touchstart");R("touchmove");R("touchend");d.event.fix=function(c){var a,b;c=Ba.call(d.event,c);if(a=c.originalEvent)if(b=a.changedTouches,c.pageX!==z&&c.offsetX===z){if(a=d(c.target).offset())c.offsetX=c.pageX-a.left,c.offsetY=c.pageY-a.top}else if(b&&(a=d(a.target).offset()))c.offsetX=b[0].pageX-a.left,c.offsetY=b[0].pageY-a.top;return c};qa={arc:"drawArc",
bezier:"drawBezier",circle:"drawArc",ellipse:"drawEllipse","function":"draw",image:"drawImage",line:"drawLine",polygon:"drawPolygon",quadratic:"drawQuadratic",rectangle:"drawRect",text:"drawText",vector:"drawVector"};d.fn.draw=function a(b){var f,h,e;b=ua(b);e=new F(b);for(f=0;f<this.length;f+=1)if((h=E(this[f]))&&e.fn)b=J(this[f],e,b,a),e.visible&&e.fn.call(this[f],h);return this};d.fn.clearCanvas=function(a){var b,f=new F(a);for(a=0;a<this.length;a+=1)if(b=E(this[a]))!f.x||!f.y||!f.width||!f.height?
(b.save(),b.setTransform(1,0,0,1,0,0),b.clearRect(0,0,this[a].width,this[a].height)):(M(b,f,f.width,f.height),b.clearRect(f.x-f.width/2,f.y-f.height/2,f.width,f.height)),b.restore();return this};d.fn.saveCanvas=function(){var a,b,f;for(a=0;a<this.length;a+=1)if(b=E(this[a]))f=K(this[a]),b.save(),f.savedTransforms=P({},f.transforms);return this};d.fn.restoreCanvas=function(){var a,b,f;for(a=0;a<this.length;a+=1)if(b=E(this[a]))f=K(this[a]),b.restore(),f.transforms=P({},f.savedTransforms);return this};
d.fn.restoreCanvasOnRedraw=function(a){var b={layer:q,fn:function(){d(this).restoreCanvas()}};P(b,a);return this.draw(b)};d.fn.translateCanvas=function b(f){var h,e,d=new F(f),g;for(h=0;h<this.length;h+=1)if(e=E(this[h]))g=K(this[h]),f=J(this[h],d,f,b),d.autosave&&e.save(),b(e,d,g.transforms);return this};d.fn.scaleCanvas=function f(h){var e,d,g=new F(h),t;for(e=0;e<this.length;e+=1)if(d=E(this[e]))t=K(this[e]),h=J(this[e],g,h,f),g.autosave&&d.save(),f(d,g,t.transforms);return this};d.fn.rotateCanvas=
function h(e){var d,g,t=new F(e),C;for(d=0;d<this.length;d+=1)if(g=E(this[d]))C=K(this[d]),e=J(this[d],t,e,h),t.autosave&&g.save(),h(g,t,C.transforms);return this};d.fn.drawRect=function e(d){var g,t,C=new F(d),w,y,x,A,s;for(g=0;g<this.length;g+=1)if(t=E(this[g]))d=J(this[g],C,d,e),C.visible&&(N(t,C),M(t,C,C.width,C.height),t.beginPath(),w=C.x-C.width/2,y=C.y-C.height/2,(s=C.cornerRadius)?(C.closed=q,x=C.x+C.width/2,A=C.y+C.height/2,0>x-w-2*s&&(s=(x-w)/2),0>A-y-2*s&&(s=(A-y)/2),t.moveTo(w+s,y),t.lineTo(x-
s,y),t.arc(x-s,y+s,s,3*I/2,2*I,B),t.lineTo(x,A-s),t.arc(x-s,A-s,s,0,I/2,B),t.lineTo(w+s,A),t.arc(w+s,A-s,s,I/2,I,B),t.lineTo(w,y+s),t.arc(w+s,y+s,s,I,3*I/2,B)):t.rect(w,y,C.width,C.height),C._event&&O(this[g],t,C),Q(this[g],t,C));return this};d.fn.drawArc=function v(d){var g,C,w=new F(d);d=d||{};w.layer&&(!w.inDegrees&&360===w.end)&&(d.end=w.end=2*I);for(g=0;g<this.length;g+=1)if(C=E(this[g]))d=J(this[g],w,d,v),w.visible&&(N(C,w),M(C,w,2*w.radius),C.beginPath(),C.arc(w.x,w.y,w.radius,w.start*w._toRad-
I/2,w.end*w._toRad-I/2,w.ccw),w._event&&O(this[g],C,w),Q(this[g],C,w));return this};d.fn.drawEllipse=function G(d){var g,w,y=new F(d),x=4*y.width/3,A=y.height;y.closed=q;for(g=0;g<this.length;g+=1)if(w=E(this[g]))d=J(this[g],y,d,G),y.visible&&(N(w,y),M(w,y,y.width,y.height),w.beginPath(),w.moveTo(y.x,y.y-A/2),w.bezierCurveTo(y.x-x/2,y.y-A/2,y.x-x/2,y.y+A/2,y.x,y.y+A/2),w.bezierCurveTo(y.x+x/2,y.y+A/2,y.x+x/2,y.y-A/2,y.x,y.y-A/2),y._event&&O(this[g],w,y),Q(this[g],w,y));return this};d.fn.drawPolygon=
function t(d){var g,y,x=new F(d),A=2*I/x.sides,s=I/x.sides,p=s+I/2,n=x.radius*V(A/2),k,m,r;x.closed=q;x.projection&&(x.concavity=-x.projection);for(g=0;g<this.length;g+=1)if(y=E(this[g]))if(d=J(this[g],x,d,t),x.visible){N(y,x);M(y,x,2*x.radius);y.beginPath();for(r=0;r<x.sides;r+=1)k=x.x+x.radius*V(p),m=x.y+x.radius*W(p),y.lineTo(k,m),x.concavity&&(k=x.x+(n+-n*x.concavity)*V(p+s),m=x.y+(n+-n*x.concavity)*W(p+s),y.lineTo(k,m)),p+=A;x._event&&O(this[g],y,x);Q(this[g],y,x)}return this};d.fn.drawLine=
function C(d){var g,x,A=new F(d),s,p,n;for(g=0;g<this.length;g+=1)if(x=E(this[g]))if(d=J(this[g],A,d,C),A.visible){N(x,A);M(x,A,0);s=1;for(x.beginPath();q;)if(p=A["x"+s],n=A["y"+s],p!==z&&n!==z)x.lineTo(p+A.x,n+A.y),s+=1;else break;A._event&&O(this[g],x,A);Q(this[g],x,A)}return this};d.fn.drawQuadratic=d.fn.drawQuad=function w(d){var g,A,s=new F(d),p,n,k,m,r;for(g=0;g<this.length;g+=1)if(A=E(this[g]))if(d=J(this[g],s,d,w),s.visible){N(A,s);M(A,s,0);p=2;A.beginPath();for(A.moveTo(s.x1+s.x,s.y1+s.y);q;)if(n=
s["x"+p],k=s["y"+p],m=s["cx"+(p-1)],r=s["cy"+(p-1)],n!==z&&k!==z&&m!==z&&r!==z)A.quadraticCurveTo(m+s.x,r+s.y,n+s.x,k+s.y),p+=1;else break;s._event&&O(this[g],A,s);Q(this[g],A,s)}return this};d.fn.drawBezier=function y(d){var g,s,p=new F(d),n,k,m,r,u,l,D,j;for(g=0;g<this.length;g+=1)if(s=E(this[g]))if(d=J(this[g],p,d,y),p.visible){N(s,p);M(s,p,0);n=2;k=1;s.beginPath();for(s.moveTo(p.x1+p.x,p.y1+p.y);q;)if(m=p["x"+n],r=p["y"+n],u=p["cx"+k],l=p["cy"+k],D=p["cx"+(k+1)],j=p["cy"+(k+1)],m!==z&&r!==z&&
u!==z&&l!==z&&D!==z&&j!==z)s.bezierCurveTo(u+p.x,l+p.y,D+p.x,j+p.y,m+p.x,r+p.y),n+=1,k+=2;else break;p._event&&O(this[g],s,p);Q(this[g],s,p)}return this};d.fn.drawVector=function x(d){var g,p,n=new F(d),k,m,r,u,l;for(g=0;g<this.length;g+=1)if(p=E(this[g]))if(d=J(this[g],n,d,x),n.visible){N(p,n);M(p,n,0);k=1;p.beginPath();u=n.x;l=n.y;for(p.moveTo(n.x,n.y);q;)if(m=n["a"+k],r=n["l"+k],m!==z&&r!==z)m=m*n._toRad-I/2,u+=r*T.cos(m),l+=r*T.sin(m),p.lineTo(u,l),k+=1;else break;n._event&&O(this[g],p,n);Q(this[g],
p,n)}return this};d.fn.drawGraph=function A(d){var p,n,k=new F(d),m,r,u,l,D,j;for(p=0;p<this.length;p+=1)if((n=E(this[p]))&&k.fn)if(d=J(this[p],k,d,A),k.visible){N(n,k);m=k.graph;r=k.domain;u=k.range;l=this[p].width;D=this[p].height;r===g&&(r=[g,g]);r[0]===g&&(r[0]=0);r[1]===g&&(r[1]=l);u===g&&(u=[g,g]);u[0]===g&&(u[0]=0);u[1]===g&&(u[1]=D);aa(p,n,k,r,u);if("y"===m)for(m=r[0]-k.x;m<=r[1]-k.x;m+=1)l=k.fn(m,k),l===g?(ba(this[p],n,k),aa(p,n,k,r,u)):n.lineTo(m+k.x,l+k.y);else if("x"===m)for(l=u[0]-k.y;l<=
u[1]-k.y;l+=1)m=k.fn(l,k),m===g?(ba(this[p],n,k),aa(p,n,k,r,u)):n.lineTo(m+k.x,l+k.y);else if("r"===m)for(j=0;j<2*I;j+=I/180)D=k.fn(j,k),m=D*V(j),l=D*W(j),D===g?(ba(this[p],n,k),aa(n,k,r,u)):n.lineTo(m+k.x,l+k.y);ba(this[p],n,k)}};d.fn.drawText=function s(p){var n,k,m=new F(p),r,u,l,D;for(n=0;n<this.length;n+=1)if(d(this[n]),k=E(this[n]))if(p=J(this[n],m,p,s),m.visible){N(k,m);k.textBaseline=m.baseline;k.textAlign=m.align;va(k,m);!n&&m.maxWidth!==g?r=xa(k,m):n||(r=String(m.text).split("\n"));n||wa(this[n],
k,m,r);M(k,m,m.width,m.height);n||(l=m.x,"left"===m.align?l-=m.width/2:"right"===m.align&&(l+=m.width/2));for(u=0;u<r.length;u+=1)k.shadowColor=m.shadowColor,D=m.y+u*m.height/r.length-(r.length-1)*m.height/r.length/2,k.fillText(r[u],l,D),"transparent"!==m.fillStyle&&(k.shadowColor="transparent"),k.strokeText(r[u],l,D);m._event?(k.beginPath(),k.rect(m.x-m.width/2,m.y-m.height/2,m.width,m.height),k.restore(),O(this[n],k,m),k.closePath(),da(k,K(this[n]),m)):k.restore()}H=m;return this};d.fn.measureText=
function(d){var g,n;g=d!==z&&("object"!==typeof d||d.layer)?this.getLayer(d):new F(d);if(d=E(this[0]))va(d,g),n=xa(d,g),wa(this[0],d,g,n);return g};d.fn.drawImage=function p(n){function k(p,k,l){return function(){0===k&&(j.width===g&&j.sWidth===g&&(j.width=j.sWidth=q.width),j.height===g&&j.sHeight===g&&(j.height=j.sHeight=q.height),n&&j.layer&&(n.width=j.width,n.height=j.height),j.sWidth!==g&&j.sHeight!==g&&j.sx!==g&&j.sy!==g?(j.width===g&&(j.width=j.sWidth),j.height===g&&(j.height=j.sHeight),j.cropFromCenter||
(j.sx+=j.sWidth/2,j.sy+=j.sHeight/2),j.sx+j.sWidth/2>q.width&&(j.sx=q.width-j.sWidth/2),0>j.sx-j.sWidth/2&&(j.sx=j.sWidth/2),0>j.sy-j.sHeight/2&&(j.sy=j.sHeight/2),j.sy+j.sHeight/2>q.height&&(j.sy=q.height-j.sHeight/2),N(l,j),M(l,j,j.width,j.height),l.drawImage(q,j.sx-j.sWidth/2,j.sy-j.sHeight/2,j.sWidth,j.sHeight,j.x-j.width/2,j.y-j.height/2,j.width,j.height)):(N(l,j),M(l,j,j.width,j.height),l.drawImage(q,j.x-j.width/2,j.y-j.height/2,j.width,j.height)));l.beginPath();l.rect(j.x-j.width/2,j.y-j.height/
2,j.width,j.height);j._event&&O(m[k],l,j);j._transformed&&l.restore();D=K(m[k]);l.closePath();l.stroke();ka(l,D,j);da(l,D,j);j.load&&j.load.call(p,n);j.layer&&d(p).drawLayers({clear:B,resetFire:!0,index:j.index+1})}}var m=this,r,u,l,D,j=new F(n),q,z;r=j.source;z=r.getContext;r.src||z?q=r:r&&(H.source===r?q=H._source:(q=new ia,q.src=r,H.source=r,H._source=q));for(u=0;u<m.length;u+=1)if(r=m[u],l=E(m[u]))n=J(m[u],j,n,p),j.visible&&q&&(q.complete||z?k(r,u,l)():(d(q).bind("load",k(r,u,l)),q.src=q.src));
return m};d.fn.createPattern=d.fn.pattern=function(p){function n(){l=m.createPattern(u,r.repeat);r.load&&r.load.call(k[0],l)}var k=this,m,r=new F(p),u,l,q;(m=E(k[0]))?(q=r.source,U(q)?(u=ca.createElement("canvas"),u.width=r.width,u.height=r.height,p=E(u),q.call(u,p),n()):(p=q.getContext,q.src||p?u=q:(u=new ia,u.src=q),u.complete||p?n():(d(u).bind("load",n),u.src=u.src))):l=g;return l};d.fn.createGradient=d.fn.gradient=function(d){var n;d=new F(d);var k=[],m,r,q,l,D,j,B;if(n=E(this[0])){d.x1=d.x1||
0;d.y1=d.y1||0;d.x2=d.x2||0;d.y2=d.y2||0;n=d.r1!==g||d.r2!==g?n.createRadialGradient(d.x1,d.y1,d.r1,d.x2,d.y2,d.r2):n.createLinearGradient(d.x1,d.y1,d.x2,d.y2);for(l=1;d["c"+l]!==z;l+=1)d["s"+l]!==z?k.push(d["s"+l]):k.push(g);m=k.length;k[0]===g&&(k[0]=0);k[m-1]===g&&(k[m-1]=1);for(l=0;l<m;l+=1){if(k[l]!==g){j=1;B=0;r=k[l];for(D=l+1;D<m;D+=1)if(k[D]!==g){q=k[D];break}else j+=1;r>q&&(k[D]=k[l])}else k[l]===g&&(B+=1,k[l]=r+B*((q-r)/j));n.addColorStop(k[l],d["c"+(l+1)])}}else n=g;return n};d.fn.setPixels=
function n(d){var g,r,q,l=new F(d),D={},j,z,B,H;for(r=0;r<this.length;r+=1)if(g=this[r],q=E(g)){d=J(g,l,d,n);M(q,l,l.width,l.height);if(null===l.width||null===l.height)l.width=g.width,l.height=g.height,l.x=l.width/2,l.y=l.height/2;if(0!==l.width&&0!==l.height){j=q.getImageData(l.x-l.width/2,l.y-l.height/2,l.width,l.height);z=j.data;H=z.length;D=[];if(l.each)for(B=0;B<H;B+=4)D.r=z[B],D.g=z[B+1],D.b=z[B+2],D.a=z[B+3],l.each.call(g,D),z[B]=D.r,z[B+1]=D.g,z[B+2]=D.b,z[B+3]=D.a;q.putImageData(j,l.x-l.width/
2,l.y-l.height/2);q.restore()}}return this};d.fn.getCanvasImage=function(d,k){var m=this[0];k===z&&(k=1);return m&&m.toDataURL?m.toDataURL("image/"+d,k):g};d.support.canvas=ca.createElement("canvas").getContext!==z;L.defaults=Z;L.detectEvents=O;L.closePath=Q;d.jCanvas=L})(jQuery,document,Image,Math,parseFloat,!0,!1,null);
